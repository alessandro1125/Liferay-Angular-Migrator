{"version":3,"sources":["../../../../../../../../../../../../../packages/animations/browser/testing/src/mock_animation_driver.ts"],"names":[],"mappings":";;;AAAA;;;;;;;AAOA,aAAQ,UAAR,EAAqC,mBAArC,QAA2E,qBAA3E;AACA,aAA6C,mCAAmC,8BAAhF,EAAgH,oBAAoB,eAApI,EAAqJ,gBAAgB,WAArK,EAAkL,mBAAmB,cAArM,EAAqN,0BAA0B,qBAA/O,QAA2Q,6BAA3Q;AAGA;;;AAGA,QAAA,sBAAA,aAAA,YAAA;AAAA,iBAAA,mBAAA,GAAA,CA2BC;AAxBC,4BAAA,SAAA,CAAA,qBAAA,GAAA,UAAsB,IAAtB,EAAkC;AAAa,mBAAO,sBAAsB,IAAtB,CAAP;AAAqC,SAApF;AAEA,4BAAA,SAAA,CAAA,cAAA,GAAA,UAAe,OAAf,EAA6B,QAA7B,EAA6C;AAC3C,mBAAO,eAAe,OAAf,EAAwB,QAAxB,CAAP;AACD,SAFD;AAIA,4BAAA,SAAA,CAAA,eAAA,GAAA,UAAgB,IAAhB,EAA2B,IAA3B,EAAoC;AAAa,mBAAO,gBAAgB,IAAhB,EAAsB,IAAtB,CAAP;AAAqC,SAAtF;AAEA,4BAAA,SAAA,CAAA,KAAA,GAAA,UAAM,OAAN,EAAoB,QAApB,EAAsC,KAAtC,EAAoD;AAClD,mBAAO,YAAY,OAAZ,EAAqB,QAArB,EAA+B,KAA/B,CAAP;AACD,SAFD;AAIA,4BAAA,SAAA,CAAA,YAAA,GAAA,UAAa,OAAb,EAA2B,IAA3B,EAAyC,YAAzC,EAA8D;AAC5D,mBAAO,gBAAgB,EAAvB;AACD,SAFD;AAIA,4BAAA,SAAA,CAAA,OAAA,GAAA,UACI,OADJ,EACkB,SADlB,EACiE,QADjE,EACmF,KADnF,EAEI,MAFJ,EAEoB,eAFpB,EAE+C;AAA3B,gBAAA,oBAAA,KAAA,CAAA,EAAA;AAAA,kCAAA,EAAA;AAA2B;AAC7C,gBAAM,SACF,IAAI,mBAAJ,CAAwB,OAAxB,EAAiC,SAAjC,EAA4C,QAA5C,EAAsD,KAAtD,EAA6D,MAA7D,EAAqE,eAArE,CADJ;AAEA,gCAAoB,GAApB,CAAwB,IAAxB,CAA8C,MAA9C;AACA,mBAAO,MAAP;AACD,SAPD;AAlBO,4BAAA,GAAA,GAAyB,EAAzB;AA0BT,eAAA,mBAAA;AAAC,KA3BD,EAAA;aAAa,mB;AA6Bb;;;AAGA,QAAA,sBAAA,aAAA,UAAA,MAAA,EAAA;AAAyC,gBAAA,SAAA,CAAA,mBAAA,EAAA,MAAA;AAOvC,iBAAA,mBAAA,CACW,OADX,EACgC,SADhC,EAEW,QAFX,EAEoC,KAFpC,EAE0D,MAF1D,EAGW,eAHX,EAGiC;AAHjC,gBAAA,QAIE,OAAA,IAAA,CAAA,IAAA,EAAM,QAAN,EAAgB,KAAhB,KAAsB,IAJxB;AACW,kBAAA,OAAA,GAAA,OAAA;AAAqB,kBAAA,SAAA,GAAA,SAAA;AACrB,kBAAA,QAAA,GAAA,QAAA;AAAyB,kBAAA,KAAA,GAAA,KAAA;AAAsB,kBAAA,MAAA,GAAA,MAAA;AAC/C,kBAAA,eAAA,GAAA,eAAA;AATH,kBAAA,UAAA,GAAa,KAAb;AACA,kBAAA,SAAA,GAAY,KAAZ;AACD,kBAAA,cAAA,GAAmD,EAAnD;AACC,kBAAA,UAAA,GAA4B,EAA5B;AACD,kBAAA,eAAA,GAA8B,EAA9B;AAQL,gBAAI,+BAA+B,QAA/B,EAAyC,KAAzC,CAAJ,EAAqD;AACnD,gCAAgB,OAAhB,CAAwB,UAAA,MAAA,EAAM;AAC5B,wBAAI,kBAAkB,mBAAtB,EAA2C;AACzC,4BAAM,WAAS,OAAO,eAAtB;AACA,+BAAO,IAAP,CAAY,QAAZ,EAAoB,OAApB,CAA4B,UAAA,IAAA,EAAI;AAAI,mCAAA,MAAK,cAAL,CAAoB,IAApB,IAA4B,SAA5B,IAA4B,CAA5B;AAAwC,yBAA5E;AACD;AACF,iBALD;AAMD;;AACF;AAED;AACA,4BAAA,SAAA,CAAA,MAAA,GAAA,UAAO,EAAP,EAAoB;AAAI,iBAAK,UAAL,CAAgB,IAAhB,CAAqB,EAArB;AAA2B,SAAnD;AAEA;AACA,4BAAA,SAAA,CAAA,IAAA,GAAA,YAAA;AACE,mBAAA,SAAA,CAAM,IAAN,CAAU,IAAV,CAAU,IAAV;AACA,iBAAK,UAAL,CAAgB,OAAhB,CAAwB,UAAA,EAAA,EAAE;AAAI,uBAAA,IAAA;AAAI,aAAlC;AACA,iBAAK,UAAL,GAAkB,EAAlB;AACD,SAJD;AAMA,4BAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AACE,mBAAA,SAAA,CAAM,MAAN,CAAY,IAAZ,CAAY,IAAZ;AACA,iBAAK,UAAL,GAAkB,IAAlB;AACD,SAHD;AAKA,4BAAA,SAAA,CAAA,OAAA,GAAA,YAAA;AACE,mBAAA,SAAA,CAAM,OAAN,CAAa,IAAb,CAAa,IAAb;AACA,iBAAK,UAAL,GAAkB,IAAlB;AACD,SAHD;AAKA;AACA,4BAAA,SAAA,CAAA,gBAAA,GAAA,YAAA,CAAqB,CAArB;AAEA,4BAAA,SAAA,CAAA,IAAA,GAAA,YAAA;AACE,mBAAA,SAAA,CAAM,IAAN,CAAU,IAAV,CAAU,IAAV;AACA,iBAAK,SAAL,GAAiB,IAAjB;AACD,SAHD;AAKA,4BAAA,SAAA,CAAA,UAAA,GAAA,YAAA;AAAe,mBAAO,KAAK,SAAZ;AAAwB,SAAvC;AAEA,4BAAA,SAAA,CAAA,aAAA,GAAA,YAAA;AAAA,gBAAA,QAAA,IAAA;AACE,gBAAM,WAAuB,EAA7B;AAEA,mBAAO,IAAP,CAAY,KAAK,cAAjB,EAAiC,OAAjC,CAAyC,UAAA,IAAA,EAAI;AAC3C,yBAAS,IAAT,IAAiB,MAAK,cAAL,CAAoB,IAApB,CAAjB;AACD,aAFD;AAIA,gBAAI,KAAK,UAAL,EAAJ,EAAuB;AACrB;AACA;AACA;AACA,qBAAK,SAAL,CAAe,OAAf,CAAuB,UAAA,EAAA,EAAE;AACvB,2BAAO,IAAP,CAAY,EAAZ,EAAgB,OAAhB,CAAwB,UAAA,IAAA,EAAI;AAC1B,4BAAI,QAAQ,QAAZ,EAAsB;AACpB,qCAAS,IAAT,IAAiB,MAAK,UAAL,GAAkB,GAAG,IAAH,CAAlB,GAA6B,UAA9C;AACD;AACF,qBAJD;AAKD,iBAND;AAOD;AAED,iBAAK,eAAL,GAAuB,QAAvB;AACD,SArBD;AAsBF,eAAA,mBAAA;AAAC,KA3ED,CAAyC,mBAAzC,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AUTO_STYLE, AnimationPlayer, NoopAnimationPlayer, ɵStyleData} from '@angular/animations';\nimport {ɵAnimationDriver as AnimationDriver, ɵallowPreviousPlayerStylesMerge as allowPreviousPlayerStylesMerge, ɵcontainsElement as containsElement, ɵinvokeQuery as invokeQuery, ɵmatchesElement as matchesElement, ɵvalidateStyleProperty as validateStyleProperty} from '@angular/animations/browser';\n\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationDriver implements AnimationDriver {\n  static log: AnimationPlayer[] = [];\n\n  validateStyleProperty(prop: string): boolean { return validateStyleProperty(prop); }\n\n  matchesElement(element: any, selector: string): boolean {\n    return matchesElement(element, selector);\n  }\n\n  containsElement(elm1: any, elm2: any): boolean { return containsElement(elm1, elm2); }\n\n  query(element: any, selector: string, multi: boolean): any[] {\n    return invokeQuery(element, selector, multi);\n  }\n\n  computeStyle(element: any, prop: string, defaultValue?: string): string {\n    return defaultValue || '';\n  }\n\n  animate(\n      element: any, keyframes: {[key: string]: string | number}[], duration: number, delay: number,\n      easing: string, previousPlayers: any[] = []): MockAnimationPlayer {\n    const player =\n        new MockAnimationPlayer(element, keyframes, duration, delay, easing, previousPlayers);\n    MockAnimationDriver.log.push(<AnimationPlayer>player);\n    return player;\n  }\n}\n\n/**\n * @experimental Animation support is experimental.\n */\nexport class MockAnimationPlayer extends NoopAnimationPlayer {\n  private __finished = false;\n  private __started = false;\n  public previousStyles: {[key: string]: string | number} = {};\n  private _onInitFns: (() => any)[] = [];\n  public currentSnapshot: ɵStyleData = {};\n\n  constructor(\n      public element: any, public keyframes: {[key: string]: string | number}[],\n      public duration: number, public delay: number, public easing: string,\n      public previousPlayers: any[]) {\n    super(duration, delay);\n\n    if (allowPreviousPlayerStylesMerge(duration, delay)) {\n      previousPlayers.forEach(player => {\n        if (player instanceof MockAnimationPlayer) {\n          const styles = player.currentSnapshot;\n          Object.keys(styles).forEach(prop => this.previousStyles[prop] = styles[prop]);\n        }\n      });\n    }\n  }\n\n  /* @internal */\n  onInit(fn: () => any) { this._onInitFns.push(fn); }\n\n  /* @internal */\n  init() {\n    super.init();\n    this._onInitFns.forEach(fn => fn());\n    this._onInitFns = [];\n  }\n\n  finish(): void {\n    super.finish();\n    this.__finished = true;\n  }\n\n  destroy(): void {\n    super.destroy();\n    this.__finished = true;\n  }\n\n  /* @internal */\n  triggerMicrotask() {}\n\n  play(): void {\n    super.play();\n    this.__started = true;\n  }\n\n  hasStarted() { return this.__started; }\n\n  beforeDestroy() {\n    const captures: ɵStyleData = {};\n\n    Object.keys(this.previousStyles).forEach(prop => {\n      captures[prop] = this.previousStyles[prop];\n    });\n\n    if (this.hasStarted()) {\n      // when assembling the captured styles, it's important that\n      // we build the keyframe styles in the following order:\n      // {other styles within keyframes, ... previousStyles }\n      this.keyframes.forEach(kf => {\n        Object.keys(kf).forEach(prop => {\n          if (prop != 'offset') {\n            captures[prop] = this.__finished ? kf[prop] : AUTO_STYLE;\n          }\n        });\n      });\n    }\n\n    this.currentSnapshot = captures;\n  }\n}\n"],"sourceRoot":""}