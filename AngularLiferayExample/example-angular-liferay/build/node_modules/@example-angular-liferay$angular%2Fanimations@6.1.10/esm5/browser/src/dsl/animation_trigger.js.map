{"version":3,"sources":["../../../../../../../../../../../../packages/animations/browser/src/dsl/animation_trigger.ts"],"names":[],"mappings":";;AAYA,aAAQ,oBAAR,EAA8B,0BAA9B,QAA+D,gCAA/D;AAIA;;;AAGA,WAAM,SAAA,YAAA,CAAuB,IAAvB,EAAqC,GAArC,EAAoD;AACxD,eAAO,IAAI,gBAAJ,CAAqB,IAArB,EAA2B,GAA3B,CAAP;AACD;AAED;;;AAGA,QAAA,mBAAA,aAAA,YAAA;AAKE,iBAAA,gBAAA,CAAmB,IAAnB,EAAwC,GAAxC,EAAuD;AAAvD,gBAAA,QAAA,IAAA;AAAmB,iBAAA,IAAA,GAAA,IAAA;AAAqB,iBAAA,GAAA,GAAA,GAAA;AAJjC,iBAAA,mBAAA,GAAoD,EAApD;AAEA,iBAAA,MAAA,GAAsD,EAAtD;AAGL,gBAAI,MAAJ,CAAW,OAAX,CAAmB,UAAA,GAAA,EAAG;AACpB,oBAAM,gBAAiB,IAAI,OAAJ,IAAe,IAAI,OAAJ,CAAY,MAA5B,IAAuC,EAA7D;AACA,sBAAK,MAAL,CAAY,IAAI,IAAhB,IAAwB,IAAI,oBAAJ,CAAyB,IAAI,KAA7B,EAAoC,aAApC,CAAxB;AACD,aAHD;AAKA,8BAAkB,KAAK,MAAvB,EAA+B,MAA/B,EAAuC,GAAvC;AACA,8BAAkB,KAAK,MAAvB,EAA+B,OAA/B,EAAwC,GAAxC;AAEA,gBAAI,WAAJ,CAAgB,OAAhB,CAAwB,UAAA,GAAA,EAAG;AACzB,sBAAK,mBAAL,CAAyB,IAAzB,CAA8B,IAAI,0BAAJ,CAA+B,IAA/B,EAAqC,GAArC,EAA0C,MAAK,MAA/C,CAA9B;AACD,aAFD;AAIA,iBAAK,kBAAL,GAA0B,yBAAyB,IAAzB,EAA+B,KAAK,MAApC,CAA1B;AACD;AAED,eAAA,cAAA,CAAI,iBAAA,SAAJ,EAAI,iBAAJ,EAAmB;iBAAnB,YAAA;AAAwB,uBAAO,KAAK,GAAL,CAAS,UAAT,GAAsB,CAA7B;AAAiC,aAAtC;4BAAA;;AAAA,SAAnB;AAEA,yBAAA,SAAA,CAAA,eAAA,GAAA,UAAgB,YAAhB,EAAmC,SAAnC,EAAmD,OAAnD,EAAiE,MAAjE,EAA6F;AAE3F,gBAAM,QACF,KAAK,mBAAL,CAAyB,IAAzB,CAA8B,UAAA,CAAA,EAAC;AAAI,uBAAA,EAAE,KAAF,CAAQ,YAAR,EAAsB,SAAtB,EAAiC,OAAjC,EAAA,MAAA,CAAA;AAAiD,aAApF,CADJ;AAEA,mBAAO,SAAS,IAAhB;AACD,SALD;AAOA,yBAAA,SAAA,CAAA,WAAA,GAAA,UAAY,YAAZ,EAA+B,MAA/B,EAA6D,MAA7D,EAA0E;AACxE,mBAAO,KAAK,kBAAL,CAAwB,WAAxB,CAAoC,YAApC,EAAkD,MAAlD,EAA0D,MAA1D,CAAP;AACD,SAFD;AAGF,eAAA,gBAAA;AAAC,KAjCD,EAAA;;AAmCA,aAAA,wBAAA,CACI,WADJ,EAEI,MAFJ,EAEuD;AACrD,YAAM,WAAW,CAAC,UAAC,SAAD,EAAiB,OAAjB,EAA6B;AAAK,mBAAA,IAAA;AAAI,SAAvC,CAAjB;AACA,YAAM,YAAyB,EAAC,MAAI,CAAL,CAAK,cAAL,EAAuC,OAAO,EAA9C,EAAkD,SAAS,IAA3D,EAA/B;AACA,YAAM,aAA4B;AAChC,kBAAI,CAD4B,CAC5B;AAD4B,cAEhC,WAAS,SAFuB;AAGhC,sBAAQ,QAHwB;AAIhC,qBAAS,IAJuB;AAKhC,wBAAY,CALoB;AAMhC,sBAAU;AANsB,SAAlC;AAQA,eAAO,IAAI,0BAAJ,CAA+B,WAA/B,EAA4C,UAA5C,EAAwD,MAAxD,CAAP;AACD;AAED,aAAA,iBAAA,CAA2B,GAA3B,EAAsD,IAAtD,EAAoE,IAApE,EAAgF;AAC9E,YAAI,IAAI,cAAJ,CAAmB,IAAnB,CAAJ,EAA8B;AAC5B,gBAAI,CAAC,IAAI,cAAJ,CAAmB,IAAnB,CAAL,EAA+B;AAC7B,oBAAI,IAAJ,IAAY,IAAI,IAAJ,CAAZ;AACD;AACF,SAJD,MAIO,IAAI,IAAI,cAAJ,CAAmB,IAAnB,CAAJ,EAA8B;AACnC,gBAAI,IAAJ,IAAY,IAAI,IAAJ,CAAZ;AACD;AACF","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationMetadataType, ɵStyleData} from '@angular/animations';\n\nimport {copyStyles, interpolateParams} from '../util';\n\nimport {SequenceAst, StyleAst, TransitionAst, TriggerAst} from './animation_ast';\nimport {AnimationStateStyles, AnimationTransitionFactory} from './animation_transition_factory';\n\n\n\n/**\n * @experimental Animation support is experimental.\n */\nexport function buildTrigger(name: string, ast: TriggerAst): AnimationTrigger {\n  return new AnimationTrigger(name, ast);\n}\n\n/**\n* @experimental Animation support is experimental.\n*/\nexport class AnimationTrigger {\n  public transitionFactories: AnimationTransitionFactory[] = [];\n  public fallbackTransition: AnimationTransitionFactory;\n  public states: {[stateName: string]: AnimationStateStyles} = {};\n\n  constructor(public name: string, public ast: TriggerAst) {\n    ast.states.forEach(ast => {\n      const defaultParams = (ast.options && ast.options.params) || {};\n      this.states[ast.name] = new AnimationStateStyles(ast.style, defaultParams);\n    });\n\n    balanceProperties(this.states, 'true', '1');\n    balanceProperties(this.states, 'false', '0');\n\n    ast.transitions.forEach(ast => {\n      this.transitionFactories.push(new AnimationTransitionFactory(name, ast, this.states));\n    });\n\n    this.fallbackTransition = createFallbackTransition(name, this.states);\n  }\n\n  get containsQueries() { return this.ast.queryCount > 0; }\n\n  matchTransition(currentState: any, nextState: any, element: any, params: {[key: string]: any}):\n      AnimationTransitionFactory|null {\n    const entry =\n        this.transitionFactories.find(f => f.match(currentState, nextState, element, params));\n    return entry || null;\n  }\n\n  matchStyles(currentState: any, params: {[key: string]: any}, errors: any[]): ɵStyleData {\n    return this.fallbackTransition.buildStyles(currentState, params, errors);\n  }\n}\n\nfunction createFallbackTransition(\n    triggerName: string,\n    states: {[stateName: string]: AnimationStateStyles}): AnimationTransitionFactory {\n  const matchers = [(fromState: any, toState: any) => true];\n  const animation: SequenceAst = {type: AnimationMetadataType.Sequence, steps: [], options: null};\n  const transition: TransitionAst = {\n    type: AnimationMetadataType.Transition,\n    animation,\n    matchers,\n    options: null,\n    queryCount: 0,\n    depCount: 0\n  };\n  return new AnimationTransitionFactory(triggerName, transition, states);\n}\n\nfunction balanceProperties(obj: {[key: string]: any}, key1: string, key2: string) {\n  if (obj.hasOwnProperty(key1)) {\n    if (!obj.hasOwnProperty(key2)) {\n      obj[key2] = obj[key1];\n    }\n  } else if (obj.hasOwnProperty(key2)) {\n    obj[key1] = obj[key2];\n  }\n}\n"],"sourceRoot":""}