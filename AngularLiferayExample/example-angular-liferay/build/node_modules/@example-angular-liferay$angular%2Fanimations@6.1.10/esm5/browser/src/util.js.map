{"version":3,"sources":["../../../../../../../../../../../packages/animations/browser/src/util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimateTimings, AnimationMetadata, AnimationMetadataType, AnimationOptions, sequence, ɵStyleData} from '@angular/animations';\nimport {Ast as AnimationAst, AstVisitor as AnimationAstVisitor} from './dsl/animation_ast';\nimport {AnimationDslVisitor} from './dsl/animation_dsl_visitor';\nimport {isNode} from './render/shared';\n\nexport const ONE_SECOND = 1000;\n\nexport const SUBSTITUTION_EXPR_START = '{{';\nexport const SUBSTITUTION_EXPR_END = '}}';\nexport const ENTER_CLASSNAME = 'ng-enter';\nexport const LEAVE_CLASSNAME = 'ng-leave';\nexport const ENTER_SELECTOR = '.ng-enter';\nexport const LEAVE_SELECTOR = '.ng-leave';\nexport const NG_TRIGGER_CLASSNAME = 'ng-trigger';\nexport const NG_TRIGGER_SELECTOR = '.ng-trigger';\nexport const NG_ANIMATING_CLASSNAME = 'ng-animating';\nexport const NG_ANIMATING_SELECTOR = '.ng-animating';\n\nexport function resolveTimingValue(value: string | number) {\n  if (typeof value == 'number') return value;\n\n  const matches = (value as string).match(/^(-?[\\.\\d]+)(m?s)/);\n  if (!matches || matches.length < 2) return 0;\n\n  return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n}\n\nfunction _convertTimeValueToMS(value: number, unit: string): number {\n  switch (unit) {\n    case 's':\n      return value * ONE_SECOND;\n    default:  // ms or something else\n      return value;\n  }\n}\n\nexport function resolveTiming(\n    timings: string | number | AnimateTimings, errors: any[], allowNegativeValues?: boolean) {\n  return timings.hasOwnProperty('duration') ?\n      <AnimateTimings>timings :\n      parseTimeExpression(<string|number>timings, errors, allowNegativeValues);\n}\n\nfunction parseTimeExpression(\n    exp: string | number, errors: string[], allowNegativeValues?: boolean): AnimateTimings {\n  const regex = /^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i;\n  let duration: number;\n  let delay: number = 0;\n  let easing: string = '';\n  if (typeof exp === 'string') {\n    const matches = exp.match(regex);\n    if (matches === null) {\n      errors.push(`The provided timing value \"${exp}\" is invalid.`);\n      return {duration: 0, delay: 0, easing: ''};\n    }\n\n    duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n\n    const delayMatch = matches[3];\n    if (delayMatch != null) {\n      delay = _convertTimeValueToMS(Math.floor(parseFloat(delayMatch)), matches[4]);\n    }\n\n    const easingVal = matches[5];\n    if (easingVal) {\n      easing = easingVal;\n    }\n  } else {\n    duration = <number>exp;\n  }\n\n  if (!allowNegativeValues) {\n    let containsErrors = false;\n    let startIndex = errors.length;\n    if (duration < 0) {\n      errors.push(`Duration values below 0 are not allowed for this animation step.`);\n      containsErrors = true;\n    }\n    if (delay < 0) {\n      errors.push(`Delay values below 0 are not allowed for this animation step.`);\n      containsErrors = true;\n    }\n    if (containsErrors) {\n      errors.splice(startIndex, 0, `The provided timing value \"${exp}\" is invalid.`);\n    }\n  }\n\n  return {duration, delay, easing};\n}\n\nexport function copyObj(\n    obj: {[key: string]: any}, destination: {[key: string]: any} = {}): {[key: string]: any} {\n  Object.keys(obj).forEach(prop => { destination[prop] = obj[prop]; });\n  return destination;\n}\n\nexport function normalizeStyles(styles: ɵStyleData | ɵStyleData[]): ɵStyleData {\n  const normalizedStyles: ɵStyleData = {};\n  if (Array.isArray(styles)) {\n    styles.forEach(data => copyStyles(data, false, normalizedStyles));\n  } else {\n    copyStyles(styles, false, normalizedStyles);\n  }\n  return normalizedStyles;\n}\n\nexport function copyStyles(\n    styles: ɵStyleData, readPrototype: boolean, destination: ɵStyleData = {}): ɵStyleData {\n  if (readPrototype) {\n    // we make use of a for-in loop so that the\n    // prototypically inherited properties are\n    // revealed from the backFill map\n    for (let prop in styles) {\n      destination[prop] = styles[prop];\n    }\n  } else {\n    copyObj(styles, destination);\n  }\n  return destination;\n}\n\nfunction getStyleAttributeString(element: any, key: string, value: string) {\n  // Return the key-value pair string to be added to the style attribute for the\n  // given CSS style key.\n  if (value) {\n    return key + ':' + value + ';';\n  } else {\n    return '';\n  }\n}\n\nfunction writeStyleAttribute(element: any) {\n  // Read the style property of the element and manually reflect it to the\n  // style attribute. This is needed because Domino on platform-server doesn't\n  // understand the full set of allowed CSS properties and doesn't reflect some\n  // of them automatically.\n  let styleAttrValue = '';\n  for (let i = 0; i < element.style.length; i++) {\n    const key = element.style.item(i);\n    styleAttrValue += getStyleAttributeString(element, key, element.style.getPropertyValue(key));\n  }\n  for (const key in element.style) {\n    // Skip internal Domino properties that don't need to be reflected.\n    if (!element.style.hasOwnProperty(key) || key.startsWith('_')) {\n      continue;\n    }\n    const dashKey = camelCaseToDashCase(key);\n    styleAttrValue += getStyleAttributeString(element, dashKey, element.style[key]);\n  }\n  element.setAttribute('style', styleAttrValue);\n}\n\nexport function setStyles(element: any, styles: ɵStyleData) {\n  if (element['style']) {\n    Object.keys(styles).forEach(prop => {\n      const camelProp = dashCaseToCamelCase(prop);\n      element.style[camelProp] = styles[prop];\n    });\n    // On the server set the 'style' attribute since it's not automatically reflected.\n    if (isNode()) {\n      writeStyleAttribute(element);\n    }\n  }\n}\n\nexport function eraseStyles(element: any, styles: ɵStyleData) {\n  if (element['style']) {\n    Object.keys(styles).forEach(prop => {\n      const camelProp = dashCaseToCamelCase(prop);\n      element.style[camelProp] = '';\n    });\n    // On the server set the 'style' attribute since it's not automatically reflected.\n    if (isNode()) {\n      writeStyleAttribute(element);\n    }\n  }\n}\n\nexport function normalizeAnimationEntry(steps: AnimationMetadata | AnimationMetadata[]):\n    AnimationMetadata {\n  if (Array.isArray(steps)) {\n    if (steps.length == 1) return steps[0];\n    return sequence(steps);\n  }\n  return steps as AnimationMetadata;\n}\n\nexport function validateStyleParams(\n    value: string | number, options: AnimationOptions, errors: any[]) {\n  const params = options.params || {};\n  const matches = extractStyleParams(value);\n  if (matches.length) {\n    matches.forEach(varName => {\n      if (!params.hasOwnProperty(varName)) {\n        errors.push(\n            `Unable to resolve the local animation param ${varName} in the given list of values`);\n      }\n    });\n  }\n}\n\nconst PARAM_REGEX =\n    new RegExp(`${SUBSTITUTION_EXPR_START}\\\\s*(.+?)\\\\s*${SUBSTITUTION_EXPR_END}`, 'g');\nexport function extractStyleParams(value: string | number): string[] {\n  let params: string[] = [];\n  if (typeof value === 'string') {\n    const val = value.toString();\n\n    let match: any;\n    while (match = PARAM_REGEX.exec(val)) {\n      params.push(match[1] as string);\n    }\n    PARAM_REGEX.lastIndex = 0;\n  }\n  return params;\n}\n\nexport function interpolateParams(\n    value: string | number, params: {[name: string]: any}, errors: any[]): string|number {\n  const original = value.toString();\n  const str = original.replace(PARAM_REGEX, (_, varName) => {\n    let localVal = params[varName];\n    // this means that the value was never overridden by the data passed in by the user\n    if (!params.hasOwnProperty(varName)) {\n      errors.push(`Please provide a value for the animation param ${varName}`);\n      localVal = '';\n    }\n    return localVal.toString();\n  });\n\n  // we do this to assert that numeric values stay as they are\n  return str == original ? value : str;\n}\n\nexport function iteratorToArray(iterator: any): any[] {\n  const arr: any[] = [];\n  let item = iterator.next();\n  while (!item.done) {\n    arr.push(item.value);\n    item = iterator.next();\n  }\n  return arr;\n}\n\nexport function mergeAnimationOptions(\n    source: AnimationOptions, destination: AnimationOptions): AnimationOptions {\n  if (source.params) {\n    const p0 = source.params;\n    if (!destination.params) {\n      destination.params = {};\n    }\n    const p1 = destination.params;\n    Object.keys(p0).forEach(param => {\n      if (!p1.hasOwnProperty(param)) {\n        p1[param] = p0[param];\n      }\n    });\n  }\n  return destination;\n}\n\nconst DASH_CASE_REGEXP = /-+([a-z0-9])/g;\nexport function dashCaseToCamelCase(input: string): string {\n  return input.replace(DASH_CASE_REGEXP, (...m: any[]) => m[1].toUpperCase());\n}\n\nfunction camelCaseToDashCase(input: string): string {\n  return input.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n}\n\nexport function allowPreviousPlayerStylesMerge(duration: number, delay: number) {\n  return duration === 0 || delay === 0;\n}\n\nexport function balancePreviousStylesIntoKeyframes(\n    element: any, keyframes: {[key: string]: any}[], previousStyles: {[key: string]: any}) {\n  const previousStyleProps = Object.keys(previousStyles);\n  if (previousStyleProps.length && keyframes.length) {\n    let startingKeyframe = keyframes[0];\n    let missingStyleProps: string[] = [];\n    previousStyleProps.forEach(prop => {\n      if (!startingKeyframe.hasOwnProperty(prop)) {\n        missingStyleProps.push(prop);\n      }\n      startingKeyframe[prop] = previousStyles[prop];\n    });\n\n    if (missingStyleProps.length) {\n      // tslint:disable-next-line\n      for (var i = 1; i < keyframes.length; i++) {\n        let kf = keyframes[i];\n        missingStyleProps.forEach(function(prop) { kf[prop] = computeStyle(element, prop); });\n      }\n    }\n  }\n  return keyframes;\n}\n\nexport function visitDslNode(\n    visitor: AnimationDslVisitor, node: AnimationMetadata, context: any): any;\nexport function visitDslNode(\n    visitor: AnimationAstVisitor, node: AnimationAst<AnimationMetadataType>, context: any): any;\nexport function visitDslNode(visitor: any, node: any, context: any): any {\n  switch (node.type) {\n    case AnimationMetadataType.Trigger:\n      return visitor.visitTrigger(node, context);\n    case AnimationMetadataType.State:\n      return visitor.visitState(node, context);\n    case AnimationMetadataType.Transition:\n      return visitor.visitTransition(node, context);\n    case AnimationMetadataType.Sequence:\n      return visitor.visitSequence(node, context);\n    case AnimationMetadataType.Group:\n      return visitor.visitGroup(node, context);\n    case AnimationMetadataType.Animate:\n      return visitor.visitAnimate(node, context);\n    case AnimationMetadataType.Keyframes:\n      return visitor.visitKeyframes(node, context);\n    case AnimationMetadataType.Style:\n      return visitor.visitStyle(node, context);\n    case AnimationMetadataType.Reference:\n      return visitor.visitReference(node, context);\n    case AnimationMetadataType.AnimateChild:\n      return visitor.visitAnimateChild(node, context);\n    case AnimationMetadataType.AnimateRef:\n      return visitor.visitAnimateRef(node, context);\n    case AnimationMetadataType.Query:\n      return visitor.visitQuery(node, context);\n    case AnimationMetadataType.Stagger:\n      return visitor.visitStagger(node, context);\n    default:\n      throw new Error(`Unable to resolve animation metadata node #${node.type}`);\n  }\n}\n\nexport function computeStyle(element: any, prop: string): string {\n  return (<any>window.getComputedStyle(element))[prop];\n}\n"],"sourceRoot":""}