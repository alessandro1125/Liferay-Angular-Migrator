{"version":3,"sources":["../../../../../../../../../../../../../packages/animations/browser/src/render/web_animations/web_animations_driver.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationPlayer, ɵStyleData} from '@angular/animations';\n\nimport {allowPreviousPlayerStylesMerge, balancePreviousStylesIntoKeyframes, copyStyles} from '../../util';\nimport {AnimationDriver} from '../animation_driver';\nimport {CssKeyframesDriver} from '../css_keyframes/css_keyframes_driver';\nimport {containsElement, invokeQuery, isBrowser, matchesElement, validateStyleProperty} from '../shared';\n\nimport {WebAnimationsPlayer} from './web_animations_player';\n\nexport class WebAnimationsDriver implements AnimationDriver {\n  private _isNativeImpl = /\\{\\s*\\[native\\s+code\\]\\s*\\}/.test(getElementAnimateFn().toString());\n  private _cssKeyframesDriver = new CssKeyframesDriver();\n\n  validateStyleProperty(prop: string): boolean { return validateStyleProperty(prop); }\n\n  matchesElement(element: any, selector: string): boolean {\n    return matchesElement(element, selector);\n  }\n\n  containsElement(elm1: any, elm2: any): boolean { return containsElement(elm1, elm2); }\n\n  query(element: any, selector: string, multi: boolean): any[] {\n    return invokeQuery(element, selector, multi);\n  }\n\n  computeStyle(element: any, prop: string, defaultValue?: string): string {\n    return (window.getComputedStyle(element) as any)[prop] as string;\n  }\n\n  overrideWebAnimationsSupport(supported: boolean) { this._isNativeImpl = supported; }\n\n  animate(\n      element: any, keyframes: ɵStyleData[], duration: number, delay: number, easing: string,\n      previousPlayers: AnimationPlayer[] = [], scrubberAccessRequested?: boolean): AnimationPlayer {\n    const useKeyframes = !scrubberAccessRequested && !this._isNativeImpl;\n    if (useKeyframes) {\n      return this._cssKeyframesDriver.animate(\n          element, keyframes, duration, delay, easing, previousPlayers);\n    }\n\n    const fill = delay == 0 ? 'both' : 'forwards';\n    const playerOptions: {[key: string]: string | number} = {duration, delay, fill};\n    // we check for this to avoid having a null|undefined value be present\n    // for the easing (which results in an error for certain browsers #9752)\n    if (easing) {\n      playerOptions['easing'] = easing;\n    }\n\n    const previousStyles: {[key: string]: any} = {};\n    const previousWebAnimationPlayers = <WebAnimationsPlayer[]>previousPlayers.filter(\n        player => player instanceof WebAnimationsPlayer);\n\n    if (allowPreviousPlayerStylesMerge(duration, delay)) {\n      previousWebAnimationPlayers.forEach(player => {\n        let styles = player.currentSnapshot;\n        Object.keys(styles).forEach(prop => previousStyles[prop] = styles[prop]);\n      });\n    }\n\n    keyframes = keyframes.map(styles => copyStyles(styles, false));\n    keyframes = balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles);\n    return new WebAnimationsPlayer(element, keyframes, playerOptions);\n  }\n}\n\nexport function supportsWebAnimations() {\n  return typeof getElementAnimateFn() === 'function';\n}\n\nfunction getElementAnimateFn(): any {\n  return (isBrowser() && (<any>Element).prototype['animate']) || {};\n}\n"],"sourceRoot":""}