{"version":3,"sources":["../../../../../../../../../../packages/core/src/render3/ng_module_ref.ts"],"names":[],"mappings":";;;;;;;;;;AAUA,aAAQ,cAAR,QAA6B,mBAA7B;AACA,aAAQ,4BAA4B,mCAApC,QAA8E,sCAA9E;AACA,aAA6B,mBAAmB,0BAAhD,EAA4E,eAAe,sBAA3F,QAAwH,6BAAxH;AAGA,aAAQ,SAAR,QAAwB,SAAxB;AACA,aAAQ,aAAR,QAA4B,UAA5B;AACA,aAAQ,wBAAR,QAAuC,iBAAvC;AAIA,WAAO,IAAM,6BAA6C;AACxD,iBAAS,mCAD+C;AAExD,oBAAY,YAAA;AAAM,mBAAA,IAAA,wBAAA,EAAA;AAA8B,SAFQ;AAGxD,cAAM;AAHkD,KAAnD;AAMP,QAAA,cAAA,aAAA,UAAA,MAAA,EAAA;AAAoC,gBAAA,SAAA,CAAA,WAAA,EAAA,MAAA;AAQlC,iBAAA,WAAA,CAAY,YAAZ,EAAmC,cAAnC,EAAgE;AAAhE,gBAAA,QACE,OAAA,IAAA,CAAA,IAAA,KAAO,IADT;AAPA;AACA,kBAAA,oBAAA,GAAoC,EAApC;AAIA,kBAAA,UAAA,GAAkC,EAAlC;AAIE,gBAAM,cAAe,aAAqC,WAA1D;AACA,yBAAa,cACI,WADJ,EAEI,eAAa,UAAU,YAAV,CAAb,GAAoC,uCAFxC,CAAb;AAIA,kBAAK,oBAAL,GAA4B,YAAY,SAAxC;AACA,gBAAM,sBAAwC,CAC5C,0BAD4C,EAChB;AAC1B,yBAAS,sBADiB;AAE1B,0BAAU;AAFgB,aADgB,CAA9C;AAMA,kBAAK,QAAL,GAAgB,eAAe,YAAf,EAA6B,cAA7B,EAA6C,mBAA7C,CAAhB;AACA,kBAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,GAAd,CAAkB,YAAlB,CAAhB;AACA,kBAAK,wBAAL,GAAgC,IAAI,wBAAJ,EAAhC;;AACD;AAED,oBAAA,SAAA,CAAA,OAAA,GAAA,YAAA;AACE,yBAAa,cAAc,KAAK,UAAnB,EAA+B,4BAA/B,CAAb;AACA,iBAAK,UAAL,CAAkB,OAAlB,CAA0B,UAAA,EAAA,EAAE;AAAI,uBAAA,IAAA;AAAI,aAApC;AACA,iBAAK,UAAL,GAAkB,IAAlB;AACD,SAJD;AAKA,oBAAA,SAAA,CAAA,SAAA,GAAA,UAAU,QAAV,EAA8B;AAC5B,yBAAa,cAAc,KAAK,UAAnB,EAA+B,4BAA/B,CAAb;AACA,iBAAK,UAAL,CAAkB,IAAlB,CAAuB,QAAvB;AACD,SAHD;AAIF,eAAA,WAAA;AAAC,KApCD,CAAoC,sBAApC,CAAA;;AAsCA,QAAA,kBAAA,aAAA,UAAA,MAAA,EAAA;AAAwC,gBAAA,SAAA,CAAA,eAAA,EAAA,MAAA;AACtC,iBAAA,eAAA,CAAmB,UAAnB,EAAsC;AAAtC,gBAAA,QAA0C,OAAA,IAAA,CAAA,IAAA,KAAO,IAAjD;AAAmB,kBAAA,UAAA,GAAA,UAAA;;AAAiC;AAEpD,wBAAA,SAAA,CAAA,MAAA,GAAA,UAAO,cAAP,EAAoC;AAClC,mBAAO,IAAI,WAAJ,CAAgB,KAAK,UAArB,EAAiC,cAAjC,CAAP;AACD,SAFD;AAGF,eAAA,eAAA;AAAC,KAND,CAAwC,0BAAxC,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Injector} from '../di/injector';\nimport {StaticProvider} from '../di/provider';\nimport {createInjector} from '../di/r3_injector';\nimport {ComponentFactoryResolver as viewEngine_ComponentFactoryResolver} from '../linker/component_factory_resolver';\nimport {InternalNgModuleRef, NgModuleFactory as viewEngine_NgModuleFactory, NgModuleRef as viewEngine_NgModuleRef} from '../linker/ng_module_factory';\nimport {NgModuleDefInternal} from '../metadata/ng_module';\nimport {Type} from '../type';\nimport {stringify} from '../util';\nimport {assertDefined} from './assert';\nimport {ComponentFactoryResolver} from './component_ref';\n\nexport interface NgModuleType { ngModuleDef: NgModuleDefInternal<any>; }\n\nexport const COMPONENT_FACTORY_RESOLVER: StaticProvider = {\n  provide: viewEngine_ComponentFactoryResolver,\n  useFactory: () => new ComponentFactoryResolver(),\n  deps: [],\n};\n\nexport class NgModuleRef<T> extends viewEngine_NgModuleRef<T> implements InternalNgModuleRef<T> {\n  // tslint:disable-next-line:require-internal-with-underscore\n  _bootstrapComponents: Type<any>[] = [];\n  injector: Injector;\n  componentFactoryResolver: viewEngine_ComponentFactoryResolver;\n  instance: T;\n  destroyCbs: (() => void)[]|null = [];\n\n  constructor(ngModuleType: Type<T>, parentInjector: Injector|null) {\n    super();\n    const ngModuleDef = (ngModuleType as any as NgModuleType).ngModuleDef;\n    ngDevMode && assertDefined(\n                     ngModuleDef,\n                     `NgModule '${stringify(ngModuleType)}' is not a subtype of 'NgModuleType'.`);\n\n    this._bootstrapComponents = ngModuleDef.bootstrap;\n    const additionalProviders: StaticProvider[] = [\n      COMPONENT_FACTORY_RESOLVER, {\n        provide: viewEngine_NgModuleRef,\n        useValue: this,\n      }\n    ];\n    this.injector = createInjector(ngModuleType, parentInjector, additionalProviders);\n    this.instance = this.injector.get(ngModuleType);\n    this.componentFactoryResolver = new ComponentFactoryResolver();\n  }\n\n  destroy(): void {\n    ngDevMode && assertDefined(this.destroyCbs, 'NgModule already destroyed');\n    this.destroyCbs !.forEach(fn => fn());\n    this.destroyCbs = null;\n  }\n  onDestroy(callback: () => void): void {\n    ngDevMode && assertDefined(this.destroyCbs, 'NgModule already destroyed');\n    this.destroyCbs !.push(callback);\n  }\n}\n\nexport class NgModuleFactory<T> extends viewEngine_NgModuleFactory<T> {\n  constructor(public moduleType: Type<T>) { super(); }\n\n  create(parentInjector: Injector|null): viewEngine_NgModuleRef<T> {\n    return new NgModuleRef(this.moduleType, parentInjector);\n  }\n}\n"],"sourceRoot":""}