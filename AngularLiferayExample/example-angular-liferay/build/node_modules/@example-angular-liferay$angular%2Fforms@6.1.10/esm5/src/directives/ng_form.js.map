{"version":3,"sources":["../../../../../../../../../../packages/forms/src/directives/ng_form.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {AfterViewInit, Directive, EventEmitter, Inject, Input, Optional, Self, forwardRef} from '@angular/core';\n\nimport {AbstractControl, FormControl, FormGroup, FormHooks} from '../model';\nimport {NG_ASYNC_VALIDATORS, NG_VALIDATORS} from '../validators';\n\nimport {ControlContainer} from './control_container';\nimport {Form} from './form_interface';\nimport {NgControl} from './ng_control';\nimport {NgModel} from './ng_model';\nimport {NgModelGroup} from './ng_model_group';\nimport {composeAsyncValidators, composeValidators, removeDir, setUpControl, setUpFormContainer, syncPendingControls} from './shared';\n\nexport const formDirectiveProvider: any = {\n  provide: ControlContainer,\n  useExisting: forwardRef(() => NgForm)\n};\n\nconst resolvedPromise = Promise.resolve(null);\n\n/**\n * @description\n *\n * Creates a top-level `FormGroup` instance and binds it to a form\n * to track aggregate form value and validation status.\n *\n * As soon as you import the `FormsModule`, this directive becomes active by default on\n * all `<form>` tags.  You don't need to add a special selector.\n *\n * You can export the directive into a local template variable using `ngForm` as the key\n * (ex: `#myForm=\"ngForm\"`). This is optional, but useful.  Many properties from the underlying\n * `FormGroup` instance are duplicated on the directive itself, so a reference to it\n * will give you access to the aggregate value and validity status of the form, as well as\n * user interaction properties like `dirty` and `touched`.\n *\n * To register child controls with the form, you'll want to use `NgModel` with a\n * `name` attribute.  You can also use `NgModelGroup` if you'd like to create\n * sub-groups within the form.\n *\n * You can listen to the directive's `ngSubmit` event to be notified when the user has\n * triggered a form submission. The `ngSubmit` event will be emitted with the original form\n * submission event.\n *\n * In template driven forms, all `<form>` tags are automatically tagged as `NgForm`.\n * If you want to import the `FormsModule` but skip its usage in some forms,\n * for example, to use native HTML5 validation, you can add `ngNoForm` and the `<form>`\n * tags won't create an `NgForm` directive. In reactive forms, using `ngNoForm` is\n * unnecessary because the `<form>` tags are inert. In that case, you would\n * refrain from using the `formGroup` directive.\n *\n * {@example forms/ts/simpleForm/simple_form_example.ts region='Component'}\n *\n * **npm package**: `@angular/forms`\n *\n * @ngModule FormsModule\n */\n@Directive({\n  selector: 'form:not([ngNoForm]):not([formGroup]),ngForm,[ngForm]',\n  providers: [formDirectiveProvider],\n  host: {'(submit)': 'onSubmit($event)', '(reset)': 'onReset()'},\n  outputs: ['ngSubmit'],\n  exportAs: 'ngForm'\n})\nexport class NgForm extends ControlContainer implements Form,\n    AfterViewInit {\n  public readonly submitted: boolean = false;\n\n  private _directives: NgModel[] = [];\n\n  form: FormGroup;\n  ngSubmit = new EventEmitter();\n\n  /**\n   * Options for the `NgForm` instance. Accepts the following properties:\n   *\n   * **updateOn**: Serves as the default `updateOn` value for all child `NgModels` below it\n   * (unless a child has explicitly set its own value for this in `ngModelOptions`).\n   * Potential values: `'change'` | `'blur'` | `'submit'`\n   *\n   * ```html\n   * <form [ngFormOptions]=\"{updateOn: 'blur'}\">\n   *    <input name=\"one\" ngModel>  <!-- this ngModel will update on blur -->\n   * </form>\n   * ```\n   *\n   */\n  // TODO(issue/24571): remove '!'.\n  @Input('ngFormOptions') options !: {updateOn?: FormHooks};\n\n  constructor(\n      @Optional() @Self() @Inject(NG_VALIDATORS) validators: any[],\n      @Optional() @Self() @Inject(NG_ASYNC_VALIDATORS) asyncValidators: any[]) {\n    super();\n    this.form =\n        new FormGroup({}, composeValidators(validators), composeAsyncValidators(asyncValidators));\n  }\n\n  ngAfterViewInit() { this._setUpdateStrategy(); }\n\n  get formDirective(): Form { return this; }\n\n  get control(): FormGroup { return this.form; }\n\n  get path(): string[] { return []; }\n\n  get controls(): {[key: string]: AbstractControl} { return this.form.controls; }\n\n  addControl(dir: NgModel): void {\n    resolvedPromise.then(() => {\n      const container = this._findContainer(dir.path);\n      (dir as{control: FormControl}).control =\n          <FormControl>container.registerControl(dir.name, dir.control);\n      setUpControl(dir.control, dir);\n      dir.control.updateValueAndValidity({emitEvent: false});\n      this._directives.push(dir);\n    });\n  }\n\n  getControl(dir: NgModel): FormControl { return <FormControl>this.form.get(dir.path); }\n\n  removeControl(dir: NgModel): void {\n    resolvedPromise.then(() => {\n      const container = this._findContainer(dir.path);\n      if (container) {\n        container.removeControl(dir.name);\n      }\n      removeDir<NgModel>(this._directives, dir);\n    });\n  }\n\n  addFormGroup(dir: NgModelGroup): void {\n    resolvedPromise.then(() => {\n      const container = this._findContainer(dir.path);\n      const group = new FormGroup({});\n      setUpFormContainer(group, dir);\n      container.registerControl(dir.name, group);\n      group.updateValueAndValidity({emitEvent: false});\n    });\n  }\n\n  removeFormGroup(dir: NgModelGroup): void {\n    resolvedPromise.then(() => {\n      const container = this._findContainer(dir.path);\n      if (container) {\n        container.removeControl(dir.name);\n      }\n    });\n  }\n\n  getFormGroup(dir: NgModelGroup): FormGroup { return <FormGroup>this.form.get(dir.path); }\n\n  updateModel(dir: NgControl, value: any): void {\n    resolvedPromise.then(() => {\n      const ctrl = <FormControl>this.form.get(dir.path !);\n      ctrl.setValue(value);\n    });\n  }\n\n  setValue(value: {[key: string]: any}): void { this.control.setValue(value); }\n\n  onSubmit($event: Event): boolean {\n    (this as{submitted: boolean}).submitted = true;\n    syncPendingControls(this.form, this._directives);\n    this.ngSubmit.emit($event);\n    return false;\n  }\n\n  onReset(): void { this.resetForm(); }\n\n  resetForm(value: any = undefined): void {\n    this.form.reset(value);\n    (this as{submitted: boolean}).submitted = false;\n  }\n\n  private _setUpdateStrategy() {\n    if (this.options && this.options.updateOn != null) {\n      this.form._updateOn = this.options.updateOn;\n    }\n  }\n\n  /** @internal */\n  _findContainer(path: string[]): FormGroup {\n    path.pop();\n    return path.length ? <FormGroup>this.form.get(path) : this.form;\n  }\n}\n"],"sourceRoot":""}