{"version":3,"sources":["../../../../../../../packages/compiler/src/render3/r3_ast.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {SecurityContext} from '../core';\nimport {AST, BindingType, BoundElementProperty, ParsedEvent, ParsedEventType} from '../expression_parser/ast';\nimport {ParseSourceSpan} from '../parse_util';\n\nexport interface Node {\n  sourceSpan: ParseSourceSpan;\n  visit<Result>(visitor: Visitor<Result>): Result;\n}\n\nexport class Text implements Node {\n  constructor(public value: string, public sourceSpan: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitText(this); }\n}\n\nexport class BoundText implements Node {\n  constructor(public value: AST, public sourceSpan: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitBoundText(this); }\n}\n\nexport class TextAttribute implements Node {\n  constructor(\n      public name: string, public value: string, public sourceSpan: ParseSourceSpan,\n      public valueSpan?: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitTextAttribute(this); }\n}\n\nexport class BoundAttribute implements Node {\n  constructor(\n      public name: string, public type: BindingType, public securityContext: SecurityContext,\n      public value: AST, public unit: string|null, public sourceSpan: ParseSourceSpan) {}\n\n  static fromBoundElementProperty(prop: BoundElementProperty) {\n    return new BoundAttribute(\n        prop.name, prop.type, prop.securityContext, prop.value, prop.unit, prop.sourceSpan);\n  }\n\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitBoundAttribute(this); }\n}\n\nexport class BoundEvent implements Node {\n  constructor(\n      public name: string, public handler: AST, public target: string|null,\n      public phase: string|null, public sourceSpan: ParseSourceSpan) {}\n\n  static fromParsedEvent(event: ParsedEvent) {\n    const target: string|null = event.type === ParsedEventType.Regular ? event.targetOrPhase : null;\n    const phase: string|null =\n        event.type === ParsedEventType.Animation ? event.targetOrPhase : null;\n    return new BoundEvent(event.name, event.handler, target, phase, event.sourceSpan);\n  }\n\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitBoundEvent(this); }\n}\n\nexport class Element implements Node {\n  constructor(\n      public name: string, public attributes: TextAttribute[], public inputs: BoundAttribute[],\n      public outputs: BoundEvent[], public children: Node[], public references: Reference[],\n      public sourceSpan: ParseSourceSpan, public startSourceSpan: ParseSourceSpan|null,\n      public endSourceSpan: ParseSourceSpan|null) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitElement(this); }\n}\n\nexport class Template implements Node {\n  constructor(\n      public attributes: TextAttribute[], public inputs: BoundAttribute[], public children: Node[],\n      public references: Reference[], public variables: Variable[],\n      public sourceSpan: ParseSourceSpan, public startSourceSpan: ParseSourceSpan|null,\n      public endSourceSpan: ParseSourceSpan|null) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitTemplate(this); }\n}\n\nexport class Content implements Node {\n  constructor(\n      public selectorIndex: number, public attributes: TextAttribute[],\n      public sourceSpan: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitContent(this); }\n}\n\nexport class Variable implements Node {\n  constructor(public name: string, public value: string, public sourceSpan: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitVariable(this); }\n}\n\nexport class Reference implements Node {\n  constructor(public name: string, public value: string, public sourceSpan: ParseSourceSpan) {}\n  visit<Result>(visitor: Visitor<Result>): Result { return visitor.visitReference(this); }\n}\n\nexport interface Visitor<Result = any> {\n  // Returning a truthy value from `visit()` will prevent `visitAll()` from the call to the typed\n  // method and result returned will become the result included in `visitAll()`s result array.\n  visit?(node: Node): Result;\n\n  visitElement(element: Element): Result;\n  visitTemplate(template: Template): Result;\n  visitContent(content: Content): Result;\n  visitVariable(variable: Variable): Result;\n  visitReference(reference: Reference): Result;\n  visitTextAttribute(attribute: TextAttribute): Result;\n  visitBoundAttribute(attribute: BoundAttribute): Result;\n  visitBoundEvent(attribute: BoundEvent): Result;\n  visitText(text: Text): Result;\n  visitBoundText(text: BoundText): Result;\n}\n\nexport class NullVisitor implements Visitor<void> {\n  visitElement(element: Element): void {}\n  visitTemplate(template: Template): void {}\n  visitContent(content: Content): void {}\n  visitVariable(variable: Variable): void {}\n  visitReference(reference: Reference): void {}\n  visitTextAttribute(attribute: TextAttribute): void {}\n  visitBoundAttribute(attribute: BoundAttribute): void {}\n  visitBoundEvent(attribute: BoundEvent): void {}\n  visitText(text: Text): void {}\n  visitBoundText(text: BoundText): void {}\n}\n\nexport class RecursiveVisitor implements Visitor<void> {\n  visitElement(element: Element): void {\n    visitAll(this, element.attributes);\n    visitAll(this, element.children);\n    visitAll(this, element.references);\n  }\n  visitTemplate(template: Template): void {\n    visitAll(this, template.attributes);\n    visitAll(this, template.children);\n    visitAll(this, template.references);\n    visitAll(this, template.variables);\n  }\n  visitContent(content: Content): void {}\n  visitVariable(variable: Variable): void {}\n  visitReference(reference: Reference): void {}\n  visitTextAttribute(attribute: TextAttribute): void {}\n  visitBoundAttribute(attribute: BoundAttribute): void {}\n  visitBoundEvent(attribute: BoundEvent): void {}\n  visitText(text: Text): void {}\n  visitBoundText(text: BoundText): void {}\n}\n\nexport class TransformVisitor implements Visitor<Node> {\n  visitElement(element: Element): Node {\n    const newAttributes = transformAll(this, element.attributes);\n    const newInputs = transformAll(this, element.inputs);\n    const newOutputs = transformAll(this, element.outputs);\n    const newChildren = transformAll(this, element.children);\n    const newReferences = transformAll(this, element.references);\n    if (newAttributes != element.attributes || newInputs != element.inputs ||\n        newOutputs != element.outputs || newChildren != element.children ||\n        newReferences != element.references) {\n      return new Element(\n          element.name, newAttributes, newInputs, newOutputs, newChildren, newReferences,\n          element.sourceSpan, element.startSourceSpan, element.endSourceSpan);\n    }\n    return element;\n  }\n\n  visitTemplate(template: Template): Node {\n    const newAttributes = transformAll(this, template.attributes);\n    const newInputs = transformAll(this, template.inputs);\n    const newChildren = transformAll(this, template.children);\n    const newReferences = transformAll(this, template.references);\n    const newVariables = transformAll(this, template.variables);\n    if (newAttributes != template.attributes || newInputs != template.inputs ||\n        newChildren != template.children || newVariables != template.variables ||\n        newReferences != template.references) {\n      return new Template(\n          newAttributes, newInputs, newChildren, newReferences, newVariables, template.sourceSpan,\n          template.startSourceSpan, template.endSourceSpan);\n    }\n    return template;\n  }\n\n  visitContent(content: Content): Node { return content; }\n\n  visitVariable(variable: Variable): Node { return variable; }\n  visitReference(reference: Reference): Node { return reference; }\n  visitTextAttribute(attribute: TextAttribute): Node { return attribute; }\n  visitBoundAttribute(attribute: BoundAttribute): Node { return attribute; }\n  visitBoundEvent(attribute: BoundEvent): Node { return attribute; }\n  visitText(text: Text): Node { return text; }\n  visitBoundText(text: BoundText): Node { return text; }\n}\n\nexport function visitAll<Result>(visitor: Visitor<Result>, nodes: Node[]): Result[] {\n  const result: Result[] = [];\n  if (visitor.visit) {\n    for (const node of nodes) {\n      const newNode = visitor.visit(node) || node.visit(visitor);\n    }\n  } else {\n    for (const node of nodes) {\n      const newNode = node.visit(visitor);\n      if (newNode) {\n        result.push(newNode);\n      }\n    }\n  }\n  return result;\n}\n\nexport function transformAll<Result extends Node>(\n    visitor: Visitor<Node>, nodes: Result[]): Result[] {\n  const result: Result[] = [];\n  let changed = false;\n  for (const node of nodes) {\n    const newNode = node.visit(visitor);\n    if (newNode) {\n      result.push(newNode as Result);\n    }\n    changed = changed || newNode != node;\n  }\n  return changed ? result : nodes;\n}"],"sourceRoot":""}