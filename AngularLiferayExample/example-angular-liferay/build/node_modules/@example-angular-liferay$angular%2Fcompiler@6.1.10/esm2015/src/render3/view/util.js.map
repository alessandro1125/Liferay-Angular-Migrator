{"version":3,"sources":["../../../../../../../../packages/compiler/src/render3/view/util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ConstantPool} from '../../constant_pool';\nimport * as o from '../../output/output_ast';\nimport * as t from '../r3_ast';\n\nimport {R3QueryMetadata} from './api';\n\n/** Name of the temporary to use during data binding */\nexport const TEMPORARY_NAME = '_t';\n\n/** Name of the context parameter passed into a template function */\nexport const CONTEXT_NAME = 'ctx';\n\n/** Name of the RenderFlag passed into a template function */\nexport const RENDER_FLAGS = 'rf';\n\n/** The prefix reference variables */\nexport const REFERENCE_PREFIX = '_r';\n\n/** The name of the implicit context reference */\nexport const IMPLICIT_REFERENCE = '$implicit';\n\n/** Name of the i18n attributes **/\nexport const I18N_ATTR = 'i18n';\nexport const I18N_ATTR_PREFIX = 'i18n-';\n\n/** I18n separators for metadata **/\nexport const MEANING_SEPARATOR = '|';\nexport const ID_SEPARATOR = '@@';\n\n/**\n * Creates an allocator for a temporary variable.\n *\n * A variable declaration is added to the statements the first time the allocator is invoked.\n */\nexport function temporaryAllocator(statements: o.Statement[], name: string): () => o.ReadVarExpr {\n  let temp: o.ReadVarExpr|null = null;\n  return () => {\n    if (!temp) {\n      statements.push(new o.DeclareVarStmt(TEMPORARY_NAME, undefined, o.DYNAMIC_TYPE));\n      temp = o.variable(name);\n    }\n    return temp;\n  };\n}\n\n\nexport function unsupported(feature: string): never {\n  if (this) {\n    throw new Error(`Builder ${this.constructor.name} doesn't support ${feature} yet`);\n  }\n  throw new Error(`Feature ${feature} is not supported yet`);\n}\n\nexport function invalid<T>(arg: o.Expression | o.Statement | t.Node): never {\n  throw new Error(\n      `Invalid state: Visitor ${this.constructor.name} doesn't handle ${o.constructor.name}`);\n}\n\nexport function asLiteral(value: any): o.Expression {\n  if (Array.isArray(value)) {\n    return o.literalArr(value.map(asLiteral));\n  }\n  return o.literal(value, o.INFERRED_TYPE);\n}\n\nexport function conditionallyCreateMapObjectLiteral(keys: {[key: string]: string}): o.Expression|\n    null {\n  if (Object.getOwnPropertyNames(keys).length > 0) {\n    return mapToExpression(keys);\n  }\n  return null;\n}\n\nexport function mapToExpression(map: {[key: string]: any}, quoted = false): o.Expression {\n  return o.literalMap(\n      Object.getOwnPropertyNames(map).map(key => ({key, quoted, value: asLiteral(map[key])})));\n}\n\n/**\n *  Remove trailing null nodes as they are implied.\n */\nexport function trimTrailingNulls(parameters: o.Expression[]): o.Expression[] {\n  while (o.isNull(parameters[parameters.length - 1])) {\n    parameters.pop();\n  }\n  return parameters;\n}\n\nexport function getQueryPredicate(\n    query: R3QueryMetadata, constantPool: ConstantPool): o.Expression {\n  if (Array.isArray(query.predicate)) {\n    return constantPool.getConstLiteral(\n        o.literalArr(query.predicate.map(selector => o.literal(selector) as o.Expression)));\n  } else {\n    return query.predicate;\n  }\n}\n\nexport function noop() {}\n\nexport class DefinitionMap {\n  values: {key: string, quoted: boolean, value: o.Expression}[] = [];\n\n  set(key: string, value: o.Expression|null): void {\n    if (value) {\n      this.values.push({key, value, quoted: false});\n    }\n  }\n\n  toLiteralMap(): o.LiteralMapExpr { return o.literalMap(this.values); }\n}\n"],"sourceRoot":""}