{"version":3,"sources":["../../../../../../../packages/compiler/src/aot/lazy_routes.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAQA,YAAA,qBAAA,QAAA,gEAAA,CAAA;AAcA,iBAAA,cAAA,CACI,UADJ,EACyC,SADzC,EACmE;;AACjE,gBAAM,gBAA6B,EAAnC;;AACA,qBAAiC,IAAA,KAAA,QAAA,QAAA,CAAA,WAAW,gBAAX,CAA4B,SAA5B,CAAA,EAAqC,KAAA,GAAA,IAAA,EAAtE,EAAsE,CAAA,GAAA,IAAtE,EAAsE,KAAA,GAAA,IAAA,EAAtE,EAAwE;AAA7D,wBAAA,KAAA,GAAA,KAAA;AAAA,wBAAC,WAAA,GAAA,QAAD;AAAA,wBAAW,SAAA,GAAA,MAAX;AACT,wBAAI,mBAAA,cAAA,CAAe,SAAS,KAAxB,MAAmC,UAAU,MAAjD,EAAyD;AACvD,4BAAM,eAAe,qBAAqB,SAAS,QAA9B,CAArB;;AACA,iCAAoB,IAAA,iBAAA,QAAA,QAAA,CAAA,YAAA,CAAA,EAAY,mBAAA,eAAA,IAAA,EAAhC,EAAgC,CAAA,iBAAA,IAAhC,EAAgC,mBAAA,eAAA,IAAA,EAAhC,EAAkC;AAA7B,oCAAM,QAAK,iBAAA,KAAX;AACH,8CAAc,IAAd,CAAmB,eAAe,KAAf,EAAsB,SAAtB,EAAiC,OAAO,SAAxC,CAAnB;AACD;;;;;;;;;;AACF;AACF;;;;;;;;;;AACD,mBAAO,aAAP;AACD;AAZD,gBAAA,cAAA,GAAA,cAAA;AAcA,iBAAA,oBAAA,CAA8B,MAA9B,EAAgE,MAAhE,EAAqF;AAArB,gBAAA,WAAA,KAAA,CAAA,EAAA;AAAA,yBAAA,EAAA;AAAqB;;AACnF,gBAAI,OAAO,MAAP,KAAkB,QAAtB,EAAgC;AAC9B,uBAAO,IAAP,CAAY,MAAZ;AACD,aAFD,MAEO,IAAI,MAAM,OAAN,CAAc,MAAd,CAAJ,EAA2B;;AAChC,yBAAoB,IAAA,WAAA,QAAA,QAAA,CAAA,MAAA,CAAA,EAAM,aAAA,SAAA,IAAA,EAA1B,EAA0B,CAAA,WAAA,IAA1B,EAA0B,aAAA,SAAA,IAAA,EAA1B,EAA4B;AAAvB,4BAAM,QAAK,WAAA,KAAX;AACH,6CAAqB,KAArB,EAA4B,MAA5B;AACD;;;;;;;;;;AACF,aAJM,MAIA,IAAI,OAAO,YAAX,EAAyB;AAC9B,qCAAqB,OAAO,YAA5B,EAA0C,MAA1C;AACD,aAFM,MAEA,IAAI,OAAO,QAAX,EAAqB;AAC1B,qCAAqB,OAAO,QAA5B,EAAsC,MAAtC;AACD;AACD,mBAAO,MAAP;AACD;AAED,iBAAA,cAAA,CACI,KADJ,EACmB,SADnB,EAC+C,MAD/C,EACoE;AAC5D,gBAAA,KAAA,QAAA,MAAA,CAAA,MAAA,KAAA,CAAA,GAAA,CAAA,EAAA,CAAA,CAAA;AAAA,gBAAC,YAAA,GAAA,CAAA,CAAD;AAAA,gBAAY,YAAA,GAAA,CAAA,CAAZ;AACN,gBAAM,mBAAmB,UAAU,wBAAV,CACrB;AACE,4BAAY,SADd;AAEE,sBAAM;AAFR,aADqB,EAKrB,SAAS,OAAO,QAAhB,GAA2B,SALN,CAAzB;AAMA,mBAAO,EAAC,OAAO,KAAR,EAAe,QAAQ,UAAU,gBAAjC,EAAmD,kBAAgB,gBAAnE,EAAP;AACD;AAVD,gBAAA,cAAA,GAAA,cAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {CompileNgModuleMetadata, tokenReference} from '../compile_metadata';\nimport {Route} from '../core';\nimport {CompileMetadataResolver} from '../metadata_resolver';\n\nimport {AotCompilerHost} from './compiler_host';\nimport {StaticReflector} from './static_reflector';\nimport {StaticSymbol} from './static_symbol';\n\nexport interface LazyRoute {\n  module: StaticSymbol;\n  route: string;\n  referencedModule: StaticSymbol;\n}\n\nexport function listLazyRoutes(\n    moduleMeta: CompileNgModuleMetadata, reflector: StaticReflector): LazyRoute[] {\n  const allLazyRoutes: LazyRoute[] = [];\n  for (const {provider, module} of moduleMeta.transitiveModule.providers) {\n    if (tokenReference(provider.token) === reflector.ROUTES) {\n      const loadChildren = _collectLoadChildren(provider.useValue);\n      for (const route of loadChildren) {\n        allLazyRoutes.push(parseLazyRoute(route, reflector, module.reference));\n      }\n    }\n  }\n  return allLazyRoutes;\n}\n\nfunction _collectLoadChildren(routes: string | Route | Route[], target: string[] = []): string[] {\n  if (typeof routes === 'string') {\n    target.push(routes);\n  } else if (Array.isArray(routes)) {\n    for (const route of routes) {\n      _collectLoadChildren(route, target);\n    }\n  } else if (routes.loadChildren) {\n    _collectLoadChildren(routes.loadChildren, target);\n  } else if (routes.children) {\n    _collectLoadChildren(routes.children, target);\n  }\n  return target;\n}\n\nexport function parseLazyRoute(\n    route: string, reflector: StaticReflector, module?: StaticSymbol): LazyRoute {\n  const [routePath, routeName] = route.split('#');\n  const referencedModule = reflector.resolveExternalReference(\n      {\n        moduleName: routePath,\n        name: routeName,\n      },\n      module ? module.filePath : undefined);\n  return {route: route, module: module || referencedModule, referencedModule};\n}\n"],"sourceRoot":""}