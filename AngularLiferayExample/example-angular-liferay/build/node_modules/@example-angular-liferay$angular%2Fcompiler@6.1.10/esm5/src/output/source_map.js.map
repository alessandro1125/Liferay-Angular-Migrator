{"version":3,"sources":["../../../../../../../../../../packages/compiler/src/output/source_map.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {utf8Encode} from '../util';\n\n// https://docs.google.com/document/d/1U1RGAehQwRypUTovF1KRlpiOFze0b-_2gc6fAH0KY0k/edit\nconst VERSION = 3;\n\nconst JS_B64_PREFIX = '# sourceMappingURL=data:application/json;base64,';\n\ntype Segment = {\n  col0: number,\n  sourceUrl?: string,\n  sourceLine0?: number,\n  sourceCol0?: number,\n};\n\nexport type SourceMap = {\n  version: number,\n  file?: string,\n  sourceRoot: string,\n  sources: string[],\n  sourcesContent: (string | null)[],\n  mappings: string,\n};\n\nexport class SourceMapGenerator {\n  private sourcesContent: Map<string, string|null> = new Map();\n  private lines: Segment[][] = [];\n  private lastCol0: number = 0;\n  private hasMappings = false;\n\n  constructor(private file: string|null = null) {}\n\n  // The content is `null` when the content is expected to be loaded using the URL\n  addSource(url: string, content: string|null = null): this {\n    if (!this.sourcesContent.has(url)) {\n      this.sourcesContent.set(url, content);\n    }\n    return this;\n  }\n\n  addLine(): this {\n    this.lines.push([]);\n    this.lastCol0 = 0;\n    return this;\n  }\n\n  addMapping(col0: number, sourceUrl?: string, sourceLine0?: number, sourceCol0?: number): this {\n    if (!this.currentLine) {\n      throw new Error(`A line must be added before mappings can be added`);\n    }\n    if (sourceUrl != null && !this.sourcesContent.has(sourceUrl)) {\n      throw new Error(`Unknown source file \"${sourceUrl}\"`);\n    }\n    if (col0 == null) {\n      throw new Error(`The column in the generated code must be provided`);\n    }\n    if (col0 < this.lastCol0) {\n      throw new Error(`Mapping should be added in output order`);\n    }\n    if (sourceUrl && (sourceLine0 == null || sourceCol0 == null)) {\n      throw new Error(`The source location must be provided when a source url is provided`);\n    }\n\n    this.hasMappings = true;\n    this.lastCol0 = col0;\n    this.currentLine.push({col0, sourceUrl, sourceLine0, sourceCol0});\n    return this;\n  }\n\n  private get currentLine(): Segment[]|null { return this.lines.slice(-1)[0]; }\n\n  toJSON(): SourceMap|null {\n    if (!this.hasMappings) {\n      return null;\n    }\n\n    const sourcesIndex = new Map<string, number>();\n    const sources: string[] = [];\n    const sourcesContent: (string | null)[] = [];\n\n    Array.from(this.sourcesContent.keys()).forEach((url: string, i: number) => {\n      sourcesIndex.set(url, i);\n      sources.push(url);\n      sourcesContent.push(this.sourcesContent.get(url) || null);\n    });\n\n    let mappings: string = '';\n    let lastCol0: number = 0;\n    let lastSourceIndex: number = 0;\n    let lastSourceLine0: number = 0;\n    let lastSourceCol0: number = 0;\n\n    this.lines.forEach(segments => {\n      lastCol0 = 0;\n\n      mappings += segments\n                      .map(segment => {\n                        // zero-based starting column of the line in the generated code\n                        let segAsStr = toBase64VLQ(segment.col0 - lastCol0);\n                        lastCol0 = segment.col0;\n\n                        if (segment.sourceUrl != null) {\n                          // zero-based index into the “sources” list\n                          segAsStr +=\n                              toBase64VLQ(sourcesIndex.get(segment.sourceUrl) ! - lastSourceIndex);\n                          lastSourceIndex = sourcesIndex.get(segment.sourceUrl) !;\n                          // the zero-based starting line in the original source\n                          segAsStr += toBase64VLQ(segment.sourceLine0 ! - lastSourceLine0);\n                          lastSourceLine0 = segment.sourceLine0 !;\n                          // the zero-based starting column in the original source\n                          segAsStr += toBase64VLQ(segment.sourceCol0 ! - lastSourceCol0);\n                          lastSourceCol0 = segment.sourceCol0 !;\n                        }\n\n                        return segAsStr;\n                      })\n                      .join(',');\n      mappings += ';';\n    });\n\n    mappings = mappings.slice(0, -1);\n\n    return {\n      'file': this.file || '',\n      'version': VERSION,\n      'sourceRoot': '',\n      'sources': sources,\n      'sourcesContent': sourcesContent,\n      'mappings': mappings,\n    };\n  }\n\n  toJsComment(): string {\n    return this.hasMappings ? '//' + JS_B64_PREFIX + toBase64String(JSON.stringify(this, null, 0)) :\n                              '';\n  }\n}\n\nexport function toBase64String(value: string): string {\n  let b64 = '';\n  value = utf8Encode(value);\n  for (let i = 0; i < value.length;) {\n    const i1 = value.charCodeAt(i++);\n    const i2 = value.charCodeAt(i++);\n    const i3 = value.charCodeAt(i++);\n    b64 += toBase64Digit(i1 >> 2);\n    b64 += toBase64Digit(((i1 & 3) << 4) | (isNaN(i2) ? 0 : i2 >> 4));\n    b64 += isNaN(i2) ? '=' : toBase64Digit(((i2 & 15) << 2) | (i3 >> 6));\n    b64 += isNaN(i2) || isNaN(i3) ? '=' : toBase64Digit(i3 & 63);\n  }\n\n  return b64;\n}\n\nfunction toBase64VLQ(value: number): string {\n  value = value < 0 ? ((-value) << 1) + 1 : value << 1;\n\n  let out = '';\n  do {\n    let digit = value & 31;\n    value = value >> 5;\n    if (value > 0) {\n      digit = digit | 32;\n    }\n    out += toBase64Digit(digit);\n  } while (value > 0);\n\n  return out;\n}\n\nconst B64_DIGITS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\nfunction toBase64Digit(value: number): string {\n  if (value < 0 || value >= 64) {\n    throw new Error(`Can only encode value in the range [0, 63]`);\n  }\n\n  return B64_DIGITS[value];\n}\n"],"sourceRoot":""}