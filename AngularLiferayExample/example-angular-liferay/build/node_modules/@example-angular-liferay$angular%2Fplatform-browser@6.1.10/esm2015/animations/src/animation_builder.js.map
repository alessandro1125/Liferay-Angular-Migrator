{"version":3,"sources":["../../../../../../../packages/platform-browser/animations/src/animation_builder.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationBuilder, AnimationFactory, AnimationMetadata, AnimationOptions, AnimationPlayer, NoopAnimationPlayer, sequence} from '@angular/animations';\nimport {Inject, Injectable, RendererFactory2, RendererType2, ViewEncapsulation} from '@angular/core';\nimport {DOCUMENT} from '@angular/platform-browser';\n\nimport {AnimationRenderer} from './animation_renderer';\n\n@Injectable()\nexport class BrowserAnimationBuilder extends AnimationBuilder {\n  private _nextAnimationId = 0;\n  private _renderer: AnimationRenderer;\n\n  constructor(rootRenderer: RendererFactory2, @Inject(DOCUMENT) doc: any) {\n    super();\n    const typeData = {\n      id: '0',\n      encapsulation: ViewEncapsulation.None,\n      styles: [],\n      data: {animation: []}\n    } as RendererType2;\n    this._renderer = rootRenderer.createRenderer(doc.body, typeData) as AnimationRenderer;\n  }\n\n  build(animation: AnimationMetadata|AnimationMetadata[]): AnimationFactory {\n    const id = this._nextAnimationId.toString();\n    this._nextAnimationId++;\n    const entry = Array.isArray(animation) ? sequence(animation) : animation;\n    issueAnimationCommand(this._renderer, null, id, 'register', [entry]);\n    return new BrowserAnimationFactory(id, this._renderer);\n  }\n}\n\nexport class BrowserAnimationFactory extends AnimationFactory {\n  constructor(private _id: string, private _renderer: AnimationRenderer) { super(); }\n\n  create(element: any, options?: AnimationOptions): AnimationPlayer {\n    return new RendererAnimationPlayer(this._id, element, options || {}, this._renderer);\n  }\n}\n\nexport class RendererAnimationPlayer implements AnimationPlayer {\n  public parentPlayer: AnimationPlayer|null = null;\n  private _started = false;\n\n  constructor(\n      public id: string, public element: any, options: AnimationOptions,\n      private _renderer: AnimationRenderer) {\n    this._command('create', options);\n  }\n\n  private _listen(eventName: string, callback: (event: any) => any): () => void {\n    return this._renderer.listen(this.element, `@@${this.id}:${eventName}`, callback);\n  }\n\n  private _command(command: string, ...args: any[]) {\n    return issueAnimationCommand(this._renderer, this.element, this.id, command, args);\n  }\n\n  onDone(fn: () => void): void { this._listen('done', fn); }\n\n  onStart(fn: () => void): void { this._listen('start', fn); }\n\n  onDestroy(fn: () => void): void { this._listen('destroy', fn); }\n\n  init(): void { this._command('init'); }\n\n  hasStarted(): boolean { return this._started; }\n\n  play(): void {\n    this._command('play');\n    this._started = true;\n  }\n\n  pause(): void { this._command('pause'); }\n\n  restart(): void { this._command('restart'); }\n\n  finish(): void { this._command('finish'); }\n\n  destroy(): void { this._command('destroy'); }\n\n  reset(): void { this._command('reset'); }\n\n  setPosition(p: number): void { this._command('setPosition', p); }\n\n  getPosition(): number { return 0; }\n\n  public totalTime = 0;\n}\n\nfunction issueAnimationCommand(\n    renderer: AnimationRenderer, element: any, id: string, command: string, args: any[]): any {\n  return renderer.setProperty(element, `@@${id}:${command}`, args);\n}\n"],"sourceRoot":""}