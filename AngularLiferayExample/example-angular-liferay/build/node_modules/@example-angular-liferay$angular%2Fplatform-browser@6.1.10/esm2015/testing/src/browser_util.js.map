{"version":3,"sources":["../../../../../../../packages/platform-browser/testing/src/browser_util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {NgZone, ɵglobal as global} from '@angular/core';\nimport {ɵgetDOM as getDOM} from '@angular/platform-browser';\n\nexport let browserDetection: BrowserDetection;\n\nexport class BrowserDetection {\n  private _overrideUa: string|null;\n  private get _ua(): string {\n    if (typeof this._overrideUa === 'string') {\n      return this._overrideUa;\n    }\n\n    return getDOM() ? getDOM().getUserAgent() : '';\n  }\n\n  static setup() { browserDetection = new BrowserDetection(null); }\n\n  constructor(ua: string|null) { this._overrideUa = ua; }\n\n  get isFirefox(): boolean { return this._ua.indexOf('Firefox') > -1; }\n\n  get isAndroid(): boolean {\n    return this._ua.indexOf('Mozilla/5.0') > -1 && this._ua.indexOf('Android') > -1 &&\n        this._ua.indexOf('AppleWebKit') > -1 && this._ua.indexOf('Chrome') == -1 &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isEdge(): boolean { return this._ua.indexOf('Edge') > -1; }\n\n  get isIE(): boolean { return this._ua.indexOf('Trident') > -1; }\n\n  get isWebkit(): boolean {\n    return this._ua.indexOf('AppleWebKit') > -1 && this._ua.indexOf('Edge') == -1 &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isIOS7(): boolean {\n    return (this._ua.indexOf('iPhone OS 7') > -1 || this._ua.indexOf('iPad OS 7') > -1) &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isSlow(): boolean { return this.isAndroid || this.isIE || this.isIOS7; }\n\n  // The Intl API is only natively supported in Chrome, Firefox, IE11 and Edge.\n  // This detector is needed in tests to make the difference between:\n  // 1) IE11/Edge: they have a native Intl API, but with some discrepancies\n  // 2) IE9/IE10: they use the polyfill, and so no discrepancies\n  get supportsNativeIntlApi(): boolean {\n    return !!(<any>global).Intl && (<any>global).Intl !== (<any>global).IntlPolyfill;\n  }\n\n  get isChromeDesktop(): boolean {\n    return this._ua.indexOf('Chrome') > -1 && this._ua.indexOf('Mobile Safari') == -1 &&\n        this._ua.indexOf('Edge') == -1;\n  }\n\n  // \"Old Chrome\" means Chrome 3X, where there are some discrepancies in the Intl API.\n  // Android 4.4 and 5.X have such browsers by default (respectively 30 and 39).\n  get isOldChrome(): boolean {\n    return this._ua.indexOf('Chrome') > -1 && this._ua.indexOf('Chrome/3') > -1 &&\n        this._ua.indexOf('Edge') == -1;\n  }\n}\n\nBrowserDetection.setup();\n\nexport function dispatchEvent(element: any, eventType: any): void {\n  getDOM().dispatchEvent(element, getDOM().createEvent(eventType));\n}\n\nexport function el(html: string): HTMLElement {\n  return <HTMLElement>getDOM().firstChild(getDOM().content(getDOM().createTemplate(html)));\n}\n\nexport function normalizeCSS(css: string): string {\n  return css.replace(/\\s+/g, ' ')\n      .replace(/:\\s/g, ':')\n      .replace(/'/g, '\"')\n      .replace(/ }/g, '}')\n      .replace(/url\\((\\\"|\\s)(.+)(\\\"|\\s)\\)(\\s*)/g, (...match: string[]) => `url(\"${match[2]}\")`)\n      .replace(/\\[(.+)=([^\"\\]]+)\\]/g, (...match: string[]) => `[${match[1]}=\"${match[2]}\"]`);\n}\n\nconst _singleTagWhitelist = ['br', 'hr', 'input'];\nexport function stringifyElement(el: any /** TODO #9100 */): string {\n  let result = '';\n  if (getDOM().isElementNode(el)) {\n    const tagName = getDOM().tagName(el).toLowerCase();\n\n    // Opening tag\n    result += `<${tagName}`;\n\n    // Attributes in an ordered way\n    const attributeMap = getDOM().attributeMap(el);\n    const sortedKeys = Array.from(attributeMap.keys()).sort();\n    for (const key of sortedKeys) {\n      const lowerCaseKey = key.toLowerCase();\n      let attValue = attributeMap.get(key);\n\n      if (typeof attValue !== 'string') {\n        result += ` ${lowerCaseKey}`;\n      } else {\n        // Browsers order style rules differently. Order them alphabetically for consistency.\n        if (lowerCaseKey === 'style') {\n          attValue = attValue.split(/; ?/).filter(s => !!s).sort().map(s => `${s};`).join(' ');\n        }\n\n        result += ` ${lowerCaseKey}=\"${attValue}\"`;\n      }\n    }\n    result += '>';\n\n    // Children\n    const childrenRoot = getDOM().templateAwareRoot(el);\n    const children = childrenRoot ? getDOM().childNodes(childrenRoot) : [];\n    for (let j = 0; j < children.length; j++) {\n      result += stringifyElement(children[j]);\n    }\n\n    // Closing tag\n    if (_singleTagWhitelist.indexOf(tagName) == -1) {\n      result += `</${tagName}>`;\n    }\n  } else if (getDOM().isCommentNode(el)) {\n    result += `<!--${getDOM().nodeValue(el)}-->`;\n  } else {\n    result += getDOM().getText(el);\n  }\n\n  return result;\n}\n\nexport function createNgZone(): NgZone {\n  return new NgZone({enableLongStackTrace: true});\n}\n"],"sourceRoot":""}