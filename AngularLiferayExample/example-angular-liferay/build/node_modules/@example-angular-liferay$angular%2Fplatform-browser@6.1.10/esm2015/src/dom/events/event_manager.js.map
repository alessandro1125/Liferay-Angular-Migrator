{"version":3,"sources":["../../../../../../../../packages/platform-browser/src/dom/events/event_manager.ts"],"names":[],"mappings":";;;;;;;;;;;;;AAQA,aAAQ,MAAR,EAAgB,UAAhB,EAA4B,cAA5B,EAA4C,MAA5C,QAAyD,eAAzD;AAEA,aAAQ,MAAR,QAAqB,gBAArB;;;;AAKA,WAAA,MAAa,wBACT,IAAI,cAAJ,CAAyC,qBAAzC,CADJ;;;;;AAQA,WAAM,MAAA,YAAA,CAAA;;;;;;AAOJ,oBAA2C,OAA3C,EAAkF,KAAlF,EAA+F;AAAb,iBAAA,KAAA,GAAA,KAAA;sCALrD,IAAI,GAAJ,E;AAM3B,oBAAQ,OAAR,CAAgB,KAAK,EAAE,OAAF,GAAY,IAAjC;AACA,iBAAK,QAAL,GAAgB,QAAQ,KAAR,GAAgB,OAAhB,EAAhB;AACD;;;;;;;;;;AAWD,yBAAiB,OAAjB,EAAuC,SAAvC,EAA0D,OAA1D,EAA2E;;AACzE,kBAAM,SAAS,KAAK,cAAL,CAAoB,SAApB,CAAf;AACA,mBAAO,OAAO,gBAAP,CAAwB,OAAxB,EAAiC,SAAjC,EAA4C,OAA5C,CAAP;AACD;;;;;;;;;;AAWD,+BAAuB,MAAvB,EAAuC,SAAvC,EAA0D,OAA1D,EAA2E;;AACzE,kBAAM,SAAS,KAAK,cAAL,CAAoB,SAApB,CAAf;AACA,mBAAO,OAAO,sBAAP,CAA8B,MAA9B,EAAsC,SAAtC,EAAiD,OAAjD,CAAP;AACD;;;;;AAKD,kBAAO;AAAa,mBAAO,KAAK,KAAZ;AAAoB;;;;;;AAGxC,uBAAe,SAAf,EAAgC;;AAC9B,kBAAM,SAAS,KAAK,kBAAL,CAAwB,GAAxB,CAA4B,SAA5B,CAAf;AACA,gBAAI,MAAJ,EAAY;AACV,uBAAO,MAAP;AACD;;AAED,kBAAM,UAAU,KAAK,QAArB;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,QAAQ,MAA5B,EAAoC,GAApC,EAAyC;;AACvC,sBAAM,SAAS,QAAQ,CAAR,CAAf;AACA,oBAAI,OAAO,QAAP,CAAgB,SAAhB,CAAJ,EAAgC;AAC9B,yBAAK,kBAAL,CAAwB,GAAxB,CAA4B,SAA5B,EAAuC,MAAvC;AACA,2BAAO,MAAP;AACD;AACF;AACD,kBAAM,IAAI,KAAJ,CAAU,2CAA2C,SAAS,EAA9D,CAAN;AACD;AA7DG;uCADL,U;;6EAQc,M,EAAM,MAAA,CAAC,qBAAD,C,eAtBuB,M;;;;;;;;;;;;AA+E5C,WAAM,MAAA,kBAAA,CAAA;;;;AACJ,oBAAoB,IAApB,EAA6B;AAAT,iBAAA,IAAA,GAAA,IAAA;AAAa;;;;;;;AASjC,+BAAuB,OAAvB,EAAwC,SAAxC,EAA2D,OAA3D,EAA4E;;AAC1E,kBAAM,SAAsB,SAAS,oBAAT,CAA8B,KAAK,IAAnC,EAAyC,OAAzC,CAA5B;AACA,gBAAI,CAAC,MAAL,EAAa;AACX,sBAAM,IAAI,KAAJ,CAAU,4BAA4B,MAAM,cAAc,SAAS,EAAnE,CAAN;AACD;AACD,mBAAO,KAAK,gBAAL,CAAsB,MAAtB,EAA8B,SAA9B,EAAyC,OAAzC,CAAP;AACD;AAhBG","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Inject, Injectable, InjectionToken, NgZone} from '@angular/core';\n\nimport {getDOM} from '../dom_adapter';\n\n/**\n * The injection token for the event-manager plug-in service.\n */\nexport const EVENT_MANAGER_PLUGINS =\n    new InjectionToken<EventManagerPlugin[]>('EventManagerPlugins');\n\n/**\n * An injectable service that provides event management for Angular\n * through a browser plug-in.\n */\n@Injectable()\nexport class EventManager {\n  private _plugins: EventManagerPlugin[];\n  private _eventNameToPlugin = new Map<string, EventManagerPlugin>();\n\n  /**\n   * Initializes an instance of the event-manager service.\n   */\n  constructor(@Inject(EVENT_MANAGER_PLUGINS) plugins: EventManagerPlugin[], private _zone: NgZone) {\n    plugins.forEach(p => p.manager = this);\n    this._plugins = plugins.slice().reverse();\n  }\n\n  /**\n   * Registers a handler for a specific element and event.\n   *\n   * @param element The HTML element to receive event notifications.\n   * @param eventName The name of the event to listen for.\n   * @param handler A function to call when the notification occurs. Receives the\n   * event object as an argument.\n   * @returns  A callback function that can be used to remove the handler.\n   */\n  addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n    const plugin = this._findPluginFor(eventName);\n    return plugin.addEventListener(element, eventName, handler);\n  }\n\n  /**\n   * Registers a global handler for an event in a target view.\n   *\n   * @param target A target for global event notifications. One of \"window\", \"document\", or \"body\".\n   * @param eventName The name of the event to listen for.\n   * @param handler A function to call when the notification occurs. Receives the\n   * event object as an argument.\n   * @returns A callback function that can be used to remove the handler.\n   */\n  addGlobalEventListener(target: string, eventName: string, handler: Function): Function {\n    const plugin = this._findPluginFor(eventName);\n    return plugin.addGlobalEventListener(target, eventName, handler);\n  }\n\n  /**\n   * Retrieves the compilation zone in which event listeners are registered.\n   */\n  getZone(): NgZone { return this._zone; }\n\n  /** @internal */\n  _findPluginFor(eventName: string): EventManagerPlugin {\n    const plugin = this._eventNameToPlugin.get(eventName);\n    if (plugin) {\n      return plugin;\n    }\n\n    const plugins = this._plugins;\n    for (let i = 0; i < plugins.length; i++) {\n      const plugin = plugins[i];\n      if (plugin.supports(eventName)) {\n        this._eventNameToPlugin.set(eventName, plugin);\n        return plugin;\n      }\n    }\n    throw new Error(`No event manager plugin found for event ${eventName}`);\n  }\n}\n\nexport abstract class EventManagerPlugin {\n  constructor(private _doc: any) {}\n\n  // TODO(issue/24571): remove '!'.\n  manager !: EventManager;\n\n  abstract supports(eventName: string): boolean;\n\n  abstract addEventListener(element: HTMLElement, eventName: string, handler: Function): Function;\n\n  addGlobalEventListener(element: string, eventName: string, handler: Function): Function {\n    const target: HTMLElement = getDOM().getGlobalEventTarget(this._doc, element);\n    if (!target) {\n      throw new Error(`Unsupported event target ${target} for event ${eventName}`);\n    }\n    return this.addEventListener(target, eventName, handler);\n  }\n}\n"],"sourceRoot":""}