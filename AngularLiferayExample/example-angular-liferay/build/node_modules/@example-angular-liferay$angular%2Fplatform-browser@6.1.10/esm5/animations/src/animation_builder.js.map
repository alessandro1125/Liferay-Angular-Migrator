{"version":3,"sources":["../../../../../../../../../../../packages/platform-browser/animations/src/animation_builder.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nimport {AnimationBuilder, AnimationFactory, AnimationMetadata, AnimationOptions, AnimationPlayer, NoopAnimationPlayer, sequence} from '@angular/animations';\nimport {Inject, Injectable, RendererFactory2, RendererType2, ViewEncapsulation} from '@angular/core';\nimport {DOCUMENT} from '@angular/platform-browser';\n\nimport {AnimationRenderer} from './animation_renderer';\n\n@Injectable()\nexport class BrowserAnimationBuilder extends AnimationBuilder {\n  private _nextAnimationId = 0;\n  private _renderer: AnimationRenderer;\n\n  constructor(rootRenderer: RendererFactory2, @Inject(DOCUMENT) doc: any) {\n    super();\n    const typeData = {\n      id: '0',\n      encapsulation: ViewEncapsulation.None,\n      styles: [],\n      data: {animation: []}\n    } as RendererType2;\n    this._renderer = rootRenderer.createRenderer(doc.body, typeData) as AnimationRenderer;\n  }\n\n  build(animation: AnimationMetadata|AnimationMetadata[]): AnimationFactory {\n    const id = this._nextAnimationId.toString();\n    this._nextAnimationId++;\n    const entry = Array.isArray(animation) ? sequence(animation) : animation;\n    issueAnimationCommand(this._renderer, null, id, 'register', [entry]);\n    return new BrowserAnimationFactory(id, this._renderer);\n  }\n}\n\nexport class BrowserAnimationFactory extends AnimationFactory {\n  constructor(private _id: string, private _renderer: AnimationRenderer) { super(); }\n\n  create(element: any, options?: AnimationOptions): AnimationPlayer {\n    return new RendererAnimationPlayer(this._id, element, options || {}, this._renderer);\n  }\n}\n\nexport class RendererAnimationPlayer implements AnimationPlayer {\n  public parentPlayer: AnimationPlayer|null = null;\n  private _started = false;\n\n  constructor(\n      public id: string, public element: any, options: AnimationOptions,\n      private _renderer: AnimationRenderer) {\n    this._command('create', options);\n  }\n\n  private _listen(eventName: string, callback: (event: any) => any): () => void {\n    return this._renderer.listen(this.element, `@@${this.id}:${eventName}`, callback);\n  }\n\n  private _command(command: string, ...args: any[]) {\n    return issueAnimationCommand(this._renderer, this.element, this.id, command, args);\n  }\n\n  onDone(fn: () => void): void { this._listen('done', fn); }\n\n  onStart(fn: () => void): void { this._listen('start', fn); }\n\n  onDestroy(fn: () => void): void { this._listen('destroy', fn); }\n\n  init(): void { this._command('init'); }\n\n  hasStarted(): boolean { return this._started; }\n\n  play(): void {\n    this._command('play');\n    this._started = true;\n  }\n\n  pause(): void { this._command('pause'); }\n\n  restart(): void { this._command('restart'); }\n\n  finish(): void { this._command('finish'); }\n\n  destroy(): void { this._command('destroy'); }\n\n  reset(): void { this._command('reset'); }\n\n  setPosition(p: number): void { this._command('setPosition', p); }\n\n  getPosition(): number { return 0; }\n\n  public totalTime = 0;\n}\n\nfunction issueAnimationCommand(\n    renderer: AnimationRenderer, element: any, id: string, command: string, args: any[]): any {\n  return renderer.setProperty(element, `@@${id}:${command}`, args);\n}\n"],"sourceRoot":""}