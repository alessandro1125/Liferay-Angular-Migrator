{"version":3,"sources":["../../../../../../../../../../../packages/platform-browser/src/dom/events/hammer_gestures.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Inject, Injectable, InjectionToken, Optional, ÉµConsole as Console} from '@angular/core';\n\nimport {DOCUMENT} from '../dom_tokens';\n\nimport {EventManagerPlugin} from './event_manager';\n\n/**\n * Supported HammerJS recognizer event names.\n */\nconst EVENT_NAMES = {\n  // pan\n  'pan': true,\n  'panstart': true,\n  'panmove': true,\n  'panend': true,\n  'pancancel': true,\n  'panleft': true,\n  'panright': true,\n  'panup': true,\n  'pandown': true,\n  // pinch\n  'pinch': true,\n  'pinchstart': true,\n  'pinchmove': true,\n  'pinchend': true,\n  'pinchcancel': true,\n  'pinchin': true,\n  'pinchout': true,\n  // press\n  'press': true,\n  'pressup': true,\n  // rotate\n  'rotate': true,\n  'rotatestart': true,\n  'rotatemove': true,\n  'rotateend': true,\n  'rotatecancel': true,\n  // swipe\n  'swipe': true,\n  'swipeleft': true,\n  'swiperight': true,\n  'swipeup': true,\n  'swipedown': true,\n  // tap\n  'tap': true,\n};\n\n/**\n * DI token for providing [HammerJS](http://hammerjs.github.io/) support to Angular.\n * @see `HammerGestureConfig`\n *\n * @experimental\n */\nexport const HAMMER_GESTURE_CONFIG = new InjectionToken<HammerGestureConfig>('HammerGestureConfig');\n\n\n/** Function that loads HammerJS, returning a promise that is resolved once HammerJs is loaded. */\nexport type HammerLoader = () => Promise<void>;\n\n/** Injection token used to provide a {@link HammerLoader} to Angular. */\nexport const HAMMER_LOADER = new InjectionToken<HammerLoader>('HammerLoader');\n\nexport interface HammerInstance {\n  on(eventName: string, callback?: Function): void;\n  off(eventName: string, callback?: Function): void;\n  destroy?(): void;\n}\n\n/**\n * An injectable [HammerJS Manager](http://hammerjs.github.io/api/#hammer.manager)\n * for gesture recognition. Configures specific event recognition.\n * @experimental\n */\n@Injectable()\nexport class HammerGestureConfig {\n  /**\n   * A set of supported event names for gestures to be used in Angular.\n   * Angular supports all built-in recognizers, as listed in\n   * [HammerJS documentation](http://hammerjs.github.io/).\n   */\n  events: string[] = [];\n\n  /**\n  * Maps gesture event names to a set of configuration options\n  * that specify overrides to the default values for specific properties.\n  *\n  * The key is a supported event name to be configured,\n  * and the options object contains a set of properties, with override values\n  * to be applied to the named recognizer event.\n  * For example, to disable recognition of the rotate event, specify\n  *  `{\"rotate\": {\"enable\": false}}`.\n  *\n  * Properties that are not present take the HammerJS default values.\n  * For information about which properties are supported for which events,\n  * and their allowed and default values, see\n  * [HammerJS documentation](http://hammerjs.github.io/).\n  *\n  */\n  overrides: {[key: string]: Object} = {};\n\n  /**\n   * Properties whose default values can be overridden for a given event.\n   * Different sets of properties apply to different events.\n   * For information about which properties are supported for which events,\n   * and their allowed and default values, see\n   * [HammerJS documentation](http://hammerjs.github.io/).\n   */\n  options?: {\n    cssProps?: any; domEvents?: boolean; enable?: boolean | ((manager: any) => boolean);\n    preset?: any[];\n    touchAction?: string;\n    recognizers?: any[];\n    inputClass?: any;\n    inputTarget?: EventTarget;\n  };\n\n  /**\n   * Creates a [HammerJS Manager](http://hammerjs.github.io/api/#hammer.manager)\n   * and attaches it to a given HTML element.\n   * @param element The element that will recognize gestures.\n   * @returns A HammerJS event-manager object.\n   */\n  buildHammer(element: HTMLElement): HammerInstance {\n    const mc = new Hammer !(element, this.options);\n\n    mc.get('pinch').set({enable: true});\n    mc.get('rotate').set({enable: true});\n\n    for (const eventName in this.overrides) {\n      mc.get(eventName).set(this.overrides[eventName]);\n    }\n\n    return mc;\n  }\n}\n\n@Injectable()\nexport class HammerGesturesPlugin extends EventManagerPlugin {\n  constructor(\n      @Inject(DOCUMENT) doc: any,\n      @Inject(HAMMER_GESTURE_CONFIG) private _config: HammerGestureConfig, private console: Console,\n      @Optional() @Inject(HAMMER_LOADER) private loader?: HammerLoader|null) {\n    super(doc);\n  }\n\n  supports(eventName: string): boolean {\n    if (!EVENT_NAMES.hasOwnProperty(eventName.toLowerCase()) && !this.isCustomEvent(eventName)) {\n      return false;\n    }\n\n    if (!(window as any).Hammer && !this.loader) {\n      this.console.warn(\n          `The \"${eventName}\" event cannot be bound because Hammer.JS is not ` +\n          `loaded and no custom loader has been specified.`);\n      return false;\n    }\n\n    return true;\n  }\n\n  addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n    const zone = this.manager.getZone();\n    eventName = eventName.toLowerCase();\n\n    // If Hammer is not present but a loader is specified, we defer adding the event listener\n    // until Hammer is loaded.\n    if (!(window as any).Hammer && this.loader) {\n      // This `addEventListener` method returns a function to remove the added listener.\n      // Until Hammer is loaded, the returned function needs to *cancel* the registration rather\n      // than remove anything.\n      let cancelRegistration = false;\n      let deregister: Function = () => { cancelRegistration = true; };\n\n      this.loader()\n          .then(() => {\n            // If Hammer isn't actually loaded when the custom loader resolves, give up.\n            if (!(window as any).Hammer) {\n              this.console.warn(\n                  `The custom HAMMER_LOADER completed, but Hammer.JS is not present.`);\n              deregister = () => {};\n              return;\n            }\n\n            if (!cancelRegistration) {\n              // Now that Hammer is loaded and the listener is being loaded for real,\n              // the deregistration function changes from canceling registration to removal.\n              deregister = this.addEventListener(element, eventName, handler);\n            }\n          })\n          .catch(() => {\n            this.console.warn(\n                `The \"${eventName}\" event cannot be bound because the custom ` +\n                `Hammer.JS loader failed.`);\n            deregister = () => {};\n          });\n\n      // Return a function that *executes* `deregister` (and not `deregister` itself) so that we\n      // can change the behavior of `deregister` once the listener is added. Using a closure in\n      // this way allows us to avoid any additional data structures to track listener removal.\n      return () => { deregister(); };\n    }\n\n    return zone.runOutsideAngular(() => {\n      // Creating the manager bind events, must be done outside of angular\n      const mc = this._config.buildHammer(element);\n      const callback = function(eventObj: HammerInput) {\n        zone.runGuarded(function() { handler(eventObj); });\n      };\n      mc.on(eventName, callback);\n      return () => {\n        mc.off(eventName, callback);\n        // destroy mc to prevent memory leak\n        if (typeof mc.destroy === 'function') {\n          mc.destroy();\n        }\n      };\n    });\n  }\n\n  isCustomEvent(eventName: string): boolean { return this._config.events.indexOf(eventName) > -1; }\n}\n"],"sourceRoot":""}