{"version":3,"sources":["../../../../../../../../../../../packages/platform-browser/testing/src/browser_util.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {NgZone, ɵglobal as global} from '@angular/core';\nimport {ɵgetDOM as getDOM} from '@angular/platform-browser';\n\nexport let browserDetection: BrowserDetection;\n\nexport class BrowserDetection {\n  private _overrideUa: string|null;\n  private get _ua(): string {\n    if (typeof this._overrideUa === 'string') {\n      return this._overrideUa;\n    }\n\n    return getDOM() ? getDOM().getUserAgent() : '';\n  }\n\n  static setup() { browserDetection = new BrowserDetection(null); }\n\n  constructor(ua: string|null) { this._overrideUa = ua; }\n\n  get isFirefox(): boolean { return this._ua.indexOf('Firefox') > -1; }\n\n  get isAndroid(): boolean {\n    return this._ua.indexOf('Mozilla/5.0') > -1 && this._ua.indexOf('Android') > -1 &&\n        this._ua.indexOf('AppleWebKit') > -1 && this._ua.indexOf('Chrome') == -1 &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isEdge(): boolean { return this._ua.indexOf('Edge') > -1; }\n\n  get isIE(): boolean { return this._ua.indexOf('Trident') > -1; }\n\n  get isWebkit(): boolean {\n    return this._ua.indexOf('AppleWebKit') > -1 && this._ua.indexOf('Edge') == -1 &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isIOS7(): boolean {\n    return (this._ua.indexOf('iPhone OS 7') > -1 || this._ua.indexOf('iPad OS 7') > -1) &&\n        this._ua.indexOf('IEMobile') == -1;\n  }\n\n  get isSlow(): boolean { return this.isAndroid || this.isIE || this.isIOS7; }\n\n  // The Intl API is only natively supported in Chrome, Firefox, IE11 and Edge.\n  // This detector is needed in tests to make the difference between:\n  // 1) IE11/Edge: they have a native Intl API, but with some discrepancies\n  // 2) IE9/IE10: they use the polyfill, and so no discrepancies\n  get supportsNativeIntlApi(): boolean {\n    return !!(<any>global).Intl && (<any>global).Intl !== (<any>global).IntlPolyfill;\n  }\n\n  get isChromeDesktop(): boolean {\n    return this._ua.indexOf('Chrome') > -1 && this._ua.indexOf('Mobile Safari') == -1 &&\n        this._ua.indexOf('Edge') == -1;\n  }\n\n  // \"Old Chrome\" means Chrome 3X, where there are some discrepancies in the Intl API.\n  // Android 4.4 and 5.X have such browsers by default (respectively 30 and 39).\n  get isOldChrome(): boolean {\n    return this._ua.indexOf('Chrome') > -1 && this._ua.indexOf('Chrome/3') > -1 &&\n        this._ua.indexOf('Edge') == -1;\n  }\n}\n\nBrowserDetection.setup();\n\nexport function dispatchEvent(element: any, eventType: any): void {\n  getDOM().dispatchEvent(element, getDOM().createEvent(eventType));\n}\n\nexport function el(html: string): HTMLElement {\n  return <HTMLElement>getDOM().firstChild(getDOM().content(getDOM().createTemplate(html)));\n}\n\nexport function normalizeCSS(css: string): string {\n  return css.replace(/\\s+/g, ' ')\n      .replace(/:\\s/g, ':')\n      .replace(/'/g, '\"')\n      .replace(/ }/g, '}')\n      .replace(/url\\((\\\"|\\s)(.+)(\\\"|\\s)\\)(\\s*)/g, (...match: string[]) => `url(\"${match[2]}\")`)\n      .replace(/\\[(.+)=([^\"\\]]+)\\]/g, (...match: string[]) => `[${match[1]}=\"${match[2]}\"]`);\n}\n\nconst _singleTagWhitelist = ['br', 'hr', 'input'];\nexport function stringifyElement(el: any /** TODO #9100 */): string {\n  let result = '';\n  if (getDOM().isElementNode(el)) {\n    const tagName = getDOM().tagName(el).toLowerCase();\n\n    // Opening tag\n    result += `<${tagName}`;\n\n    // Attributes in an ordered way\n    const attributeMap = getDOM().attributeMap(el);\n    const sortedKeys = Array.from(attributeMap.keys()).sort();\n    for (const key of sortedKeys) {\n      const lowerCaseKey = key.toLowerCase();\n      let attValue = attributeMap.get(key);\n\n      if (typeof attValue !== 'string') {\n        result += ` ${lowerCaseKey}`;\n      } else {\n        // Browsers order style rules differently. Order them alphabetically for consistency.\n        if (lowerCaseKey === 'style') {\n          attValue = attValue.split(/; ?/).filter(s => !!s).sort().map(s => `${s};`).join(' ');\n        }\n\n        result += ` ${lowerCaseKey}=\"${attValue}\"`;\n      }\n    }\n    result += '>';\n\n    // Children\n    const childrenRoot = getDOM().templateAwareRoot(el);\n    const children = childrenRoot ? getDOM().childNodes(childrenRoot) : [];\n    for (let j = 0; j < children.length; j++) {\n      result += stringifyElement(children[j]);\n    }\n\n    // Closing tag\n    if (_singleTagWhitelist.indexOf(tagName) == -1) {\n      result += `</${tagName}>`;\n    }\n  } else if (getDOM().isCommentNode(el)) {\n    result += `<!--${getDOM().nodeValue(el)}-->`;\n  } else {\n    result += getDOM().getText(el);\n  }\n\n  return result;\n}\n\nexport function createNgZone(): NgZone {\n  return new NgZone({enableLongStackTrace: true});\n}\n"],"sourceRoot":""}