{"version":3,"sources":["../../../../../../../../../../packages/http/src/backends/browser_jsonp.ts"],"names":[],"mappings":";;;;;;;;;;AAQA,aAAQ,UAAR,QAAyB,eAAzB;AAEA,QAAI,iBAAiB,CAArB;AACA,WAAO,IAAM,aAAa,cAAnB;AACP,QAAI,oBAA+C,IAAnD;AAEA,aAAA,oBAAA,GAAA;AACE,YAAM,IAA0B,OAAO,MAAP,IAAiB,QAAjB,GAA4B,MAA5B,GAAqC,EAArE;AACA,YAAI,sBAAsB,IAA1B,EAAgC;AAC9B,gCAAoB,EAAE,UAAF,IAAgB,EAApC;AACD;AACD,eAAO,iBAAP;AACD;AAED;AAEA,QAAA,eAAA,aAAA,YAAA;AAAA,iBAAA,YAAA,GAAA,CA+BC;AA9BC;AACA,qBAAA,SAAA,CAAA,KAAA,GAAA,UAAM,GAAN,EAAiB;AACf,gBAAM,OAAO,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,iBAAK,GAAL,GAAW,GAAX;AACA,mBAAO,IAAP;AACD,SAJD;AAMA,qBAAA,SAAA,CAAA,aAAA,GAAA,YAAA;AAA0B,mBAAO,UAAQ,gBAAf;AAAoC,SAA9D;AAEA,qBAAA,SAAA,CAAA,eAAA,GAAA,UAAgB,EAAhB,EAA0B;AAAY,mBAAU,aAAU,GAAV,GAAc,EAAd,GAAgB,WAA1B;AAAwC,SAA9E;AAEA,qBAAA,SAAA,CAAA,gBAAA,GAAA,UAAiB,EAAjB,EAA6B,UAA7B,EAA4C;AAC1C,gBAAM,cAAc,sBAApB;AACA,wBAAY,EAAZ,IAAkB,UAAlB;AACD,SAHD;AAKA,qBAAA,SAAA,CAAA,gBAAA,GAAA,UAAiB,EAAjB,EAA2B;AACzB,gBAAM,cAAc,sBAApB;AACA,wBAAY,EAAZ,IAAkB,IAAlB;AACD,SAHD;AAKA;AACA,qBAAA,SAAA,CAAA,IAAA,GAAA,UAAK,IAAL,EAAc;AAAI,qBAAS,IAAT,CAAc,WAAd,CAAiC,IAAjC;AAA0C,SAA5D;AAEA;AACA,qBAAA,SAAA,CAAA,OAAA,GAAA,UAAQ,IAAR,EAAiB;AACf,gBAAI,KAAK,UAAT,EAAqB;AACnB,qBAAK,UAAL,CAAgB,WAAhB,CAAmC,IAAnC;AACD;AACF,SAJD;AA1BW,uBAAY,QAAA,UAAA,CAAA,CADxB,YACwB,CAAA,EAAZ,YAAY,CAAZ;AA+Bb,eAAA,YAAA;AAAC,KA/BD,EAAA;aAAa,Y","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Injectable} from '@angular/core';\n\nlet _nextRequestId = 0;\nexport const JSONP_HOME = '__ng_jsonp__';\nlet _jsonpConnections: {[key: string]: any}|null = null;\n\nfunction _getJsonpConnections(): {[key: string]: any} {\n  const w: {[key: string]: any} = typeof window == 'object' ? window : {};\n  if (_jsonpConnections === null) {\n    _jsonpConnections = w[JSONP_HOME] = {};\n  }\n  return _jsonpConnections;\n}\n\n// Make sure not to evaluate this in a non-browser environment!\n@Injectable()\nexport class BrowserJsonp {\n  // Construct a <script> element with the specified URL\n  build(url: string): any {\n    const node = document.createElement('script');\n    node.src = url;\n    return node;\n  }\n\n  nextRequestID(): string { return `__req${_nextRequestId++}`; }\n\n  requestCallback(id: string): string { return `${JSONP_HOME}.${id}.finished`; }\n\n  exposeConnection(id: string, connection: any) {\n    const connections = _getJsonpConnections();\n    connections[id] = connection;\n  }\n\n  removeConnection(id: string) {\n    const connections = _getJsonpConnections();\n    connections[id] = null;\n  }\n\n  // Attach the <script> element to the DOM\n  send(node: any) { document.body.appendChild(<Node>(node)); }\n\n  // Remove <script> element from the DOM\n  cleanup(node: any) {\n    if (node.parentNode) {\n      node.parentNode.removeChild(<Node>(node));\n    }\n  }\n}\n"],"sourceRoot":""}